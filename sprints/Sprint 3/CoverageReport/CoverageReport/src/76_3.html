<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\matth\Desktop\capstone\CapstoneRecipePlanner\code\RecipePlannerApplication\RecipePlannerTests\PlannedMealDALTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using RecipePlannerLibrary;
using RecipePlannerLibrary.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace RecipePlannerTests
{
    public class PlannedMealDALTests
    {
        [TestClass]
        public class PlannedMealDalTests
        {
            [TestMethod]
            public void RemoveThisWeekMeal_ShouldDeleteRecord()
            {
                // Arrange
                int id = 1;
                string day = &quot;Monday&quot;;
                string type = &quot;Lunch&quot;;
                DateTime date = new DateTime(2023, 3, 13);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, id, day, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, id, day, type, date);

                // Act
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, id, day, type, date);

                // Assert
                Assert.IsFalse(PlannedMealDal.exists(this.connectionString, type, date));
            }
            private readonly string connectionString = Connection.TestsConnectionString;

            [TestMethod]
            public void AddPlannedMeal_ShouldInsertRecord()
            {
                // Arrange
                int recipeId = 1;
                string day = &quot;Monday&quot;;
                string type = &quot;Lunch&quot;;
                DateTime date = new DateTime(2023, 3, 13);

                // Act
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, recipeId, day, type, date);

                // Assert
                Assert.IsTrue(PlannedMealDal.exists(this.connectionString, type, date));
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
            }

            [TestMethod]
            public void GetThisWeeksMeals_ShouldReturnCorrectNumberOfMeals()
            {
                // Arrange
                int recipeId = 1;
                string day = &quot;Monday&quot;;
                string type = &quot;Lunch&quot;;
                DateTime date = DateTime.Now;

                // Act
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, recipeId, day, type, date);
                // Act
                var thisWeeksMeals = PlannedMealDal.getThisWeeksMeals(this.connectionString);

                // Assert
                Assert.AreEqual(1, thisWeeksMeals.Count);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);

            }

            [TestMethod]
            public void GetNextWeeksMeals_ShouldReturnCorrectNumberOfMeals()
            {
                // Arrange
                // Arrange
                int recipeId = 1;
                string day = &quot;Monday&quot;;
                string type = &quot;Lunch&quot;;
                DateTime date = DateTime.Now.AddDays(7);

                // Act
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, recipeId, day, type, date);
                // Act
                var thisWeeksMeals = PlannedMealDal.getThisWeeksMeals(this.connectionString);
                // Act
                var nextWeeksMeals = PlannedMealDal.getNextWeeksMeals(this.connectionString);

                // Assert
                Assert.AreEqual(1, nextWeeksMeals.Count);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
            }

           

            [TestMethod]
            public void Exists_ShouldReturnTrueWhenRecordExists()
            {
                // Arrange
                string type = &quot;Lunch&quot;;
                DateTime date = new DateTime(2023, 3, 13);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, 1, &quot;Monday&quot;, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, 1, &quot;Monday&quot;, type, date);

                // Act
                bool exists = PlannedMealDal.exists(this.connectionString, type, date);

                // Assert
                Assert.IsTrue(exists);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, 1, &quot;Monday&quot;, type, date);
            }

            [TestMethod]
            public void Exists_ShouldReturnFalseWhenRecordDoesNotExist()
            {
                // Arrange
                string type = &quot;Dinner&quot;;
                DateTime date = new DateTime(2023, 3, 13);

                // Act
                bool exists = PlannedMealDal.exists(this.connectionString, type, date);

                // Assert
                Assert.IsFalse(exists);
            }

            [TestMethod]
            public void UpdateThisWeeksMeal_UpdatesMeal()
            {
                // Arrange
                var day = &quot;Monday&quot;;
                var type = &quot;Lunch&quot;;
                var date = DateTime.Today;
                var recipeId = 1;
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, recipeId, day, type, date);
                PlannedMealDal.addPlannedMeal(this.connectionString, recipeId, day, type, date);
                var newRecipeId = 2;

                // Act
                PlannedMealDal.UpdateThisWeeksMeal(this.connectionString, day, type, date, newRecipeId);
                var meals = PlannedMealDal.getThisWeeksMeals(this.connectionString);

                // Assert
                Assert.AreEqual(newRecipeId, meals[(day, type)]);
                PlannedMealDal.RemoveThisWeekMeal(this.connectionString, newRecipeId, day, type, date);
            }

        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[18,13,18,14,1],[20,17,20,28,1],[21,17,21,39,1],[22,17,22,39,1],[23,17,23,59,1],[24,17,24,95,1],[25,17,25,91,1],[28,17,28,95,1],[31,17,31,90,1],[32,13,32,14,1],[33,13,33,89,1],[37,13,37,14,1],[39,17,39,34,1],[40,17,40,39,1],[41,17,41,39,1],[42,17,42,59,1],[45,17,45,101,1],[46,17,46,97,1],[49,17,49,89,1],[50,17,50,101,1],[51,13,51,14,1],[55,13,55,14,1],[57,17,57,34,1],[58,17,58,39,1],[59,17,59,39,1],[60,17,60,46,1],[63,17,63,101,1],[64,17,64,97,1],[66,17,66,94,1],[69,17,69,58,1],[70,17,70,101,1],[72,13,72,14,1],[76,13,76,14,1],[79,17,79,34,1],[80,17,80,39,1],[81,17,81,39,1],[82,17,82,57,1],[85,17,85,101,1],[86,17,86,97,1],[88,17,88,94,1],[90,17,90,94,1],[93,17,93,58,1],[94,17,94,101,1],[95,13,95,14,1],[101,13,101,14,1],[103,17,103,39,1],[104,17,104,59,1],[105,17,105,99,1],[106,17,106,95,1],[109,17,109,88,1],[112,17,112,39,1],[113,17,113,99,1],[114,13,114,14,1],[118,13,118,14,1],[120,17,120,40,1],[121,17,121,59,1],[124,17,124,88,1],[127,17,127,40,1],[128,13,128,14,1],[132,13,132,14,1],[134,17,134,36,1],[135,17,135,36,1],[136,17,136,43,1],[137,17,137,34,1],[138,17,138,101,1],[139,17,139,97,1],[140,17,140,37,1],[143,17,143,105,1],[144,17,144,85,1],[147,17,147,66,1],[148,17,148,104,1],[149,13,149,14,1]]);
    </script>
  </body>
</html>