<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\matth\Desktop\capstone\CapstoneRecipePlanner\code\RecipePlannerApplication\RecipePlannerLibrary\Database\RecipeDAL.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using MySql.Data.MySqlClient;
using RecipePlannerLibrary.Models;
using System.Collections.Generic;

namespace RecipePlannerLibrary.Database
{
    /// &lt;summary&gt;
    ///     Recipe DAL
    /// &lt;/summary&gt;
    public class RecipeDAL
    {
        #region Methods

        /// &lt;summary&gt;
        ///     Gets all of the recipes from the recipe table.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;connectionString&quot;&gt;The connection string for the table.&lt;/param&gt;
        /// &lt;returns&gt;List of all recipes&lt;/returns&gt;
        public static List&lt;Recipe&gt; getRecipes(string connectionString)
        {
            using var connection = new MySqlConnection(connectionString);
            connection.Open();
            var recipes = new List&lt;Recipe&gt;();
            var query = @&quot;Select * from recipe;&quot;;
            using var command = new MySqlCommand(query, connection);
            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                var recipeID = reader.GetInt32(0);
                var name = reader.GetString(1);
                var description = reader.GetString(2);

                var recipe = new Recipe(recipeID, name, description);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipeID, connectionString);

                recipes.Add(recipe);
            }

            connection.Close();
            return recipes;
        }

        public static string getRecipeNameById(int recipeId, string connectionString)
        {
            Recipe recipe = new Recipe();
            using var connection = new MySqlConnection(connectionString);
            connection.Open();
            var query = @&quot;Select name from recipe where recipeID=@recipeId;&quot;;
            using var command = new MySqlCommand(query, connection);
            command.Parameters.Add(&quot;@recipeId&quot;, MySqlDbType.Int32).Value = recipeId;
            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                var name = reader.GetString(0);

                recipe.Name = name;
                //recipe = new Recipe(recipeID, name);
            }

            connection.Close();
            return recipe.Name;
        }

        /// &lt;summary&gt;
        ///     Gets the ingredients associated with a specified recipeID.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;the recipe id.&lt;/param&gt;
        /// &lt;param name=&quot;connectionString&quot;&gt;The connection string for the table.&lt;/param&gt;
        /// &lt;returns&gt;List of all ingredients associated with specified recipeID&lt;/returns&gt;
        public static List&lt;RecipeIngredient&gt; getIngredientsForRecipe(int id, string connectionString)
        {
            using var connection = new MySqlConnection(connectionString);
            connection.Open();
            var ingredients = new List&lt;RecipeIngredient&gt;();
            var query = @&quot;Select * from recipe_ingredient where recipeID=@id;&quot;;
            using var command = new MySqlCommand(query, connection);
            command.Parameters.Add(&quot;@id&quot;, MySqlDbType.Int32).Value = id;
            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                var recipeID = reader.GetInt32(0);
                var ingredientName = reader.GetString(1);
                var quantity = reader.GetInt32(2);
                var measurement = reader.GetString(3);

                var ingredient = new RecipeIngredient(recipeID, ingredientName, quantity, measurement);
                ingredients.Add(ingredient);
            }

            connection.Close();
            return ingredients;
        }

        /// &lt;summary&gt;
        ///     Gets the recipe steps associated with a specified recipeID.
        /// &lt;/summary&gt;
        ///
        /// &lt;param name=&quot;id&quot;&gt;The recipe id.&lt;/param&gt;
        /// &lt;param name=&quot;connectionString&quot;&gt;The connection string for the table.&lt;/param&gt;
        /// &lt;returns&gt;List of all steps associated with a specified recipeID&lt;/returns&gt;
        public static List&lt;RecipeStep&gt; getStepsForRecipe(int id, string connectionString)
        {
            using var connection = new MySqlConnection(connectionString);
            connection.Open();
            var steps = new List&lt;RecipeStep&gt;();
            var query = @&quot;Select * from recipe_step where recipeID=@id;&quot;;
            using var command = new MySqlCommand(query, connection);
            command.Parameters.Add(&quot;@id&quot;, MySqlDbType.Int32).Value = id;
            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                var recipeID = reader.GetInt32(0);
                var stepNumber = reader.GetInt32(1);
                var stepDescription = reader.GetString(2);

                var recipeStep = new RecipeStep(recipeID, stepNumber, stepDescription);
                steps.Add(recipeStep);
            }

            connection.Close();
            return steps;
        }

        /// &lt;summary&gt;
        ///     Gets the recipe tags associated with a specified recipeID.
        /// &lt;/summary&gt;
        ///
        /// &lt;param name=&quot;id&quot;&gt;The recipe id.&lt;/param&gt;
        /// &lt;param name=&quot;connectionString&quot;&gt;The connection string for the table.&lt;/param&gt;
        /// &lt;returns&gt;List of all tags associated with a specified recipeID&lt;/returns&gt;
        public static List&lt;string&gt; getTagsForRecipe(int id, string connectionString)
        {
            using var connection = new MySqlConnection(connectionString);
            connection.Open();
            var tags = new List&lt;string&gt;();
            var query = @&quot;Select * from recipe_tag where recipeID=@id;&quot;;
            using var command = new MySqlCommand(query, connection);
            command.Parameters.Add(&quot;@id&quot;, MySqlDbType.Int32).Value = id;
            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                var tagName = reader.GetString(1);
                tags.Add(tagName);
            }

            connection.Close();
            return tags;
        }

        #endregion
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,9,20,10,1],[21,13,21,74,1],[22,13,22,31,1],[23,13,23,46,1],[24,13,24,50,1],[25,13,25,69,1],[26,13,26,56,1],[27,13,27,34,1],[28,13,28,14,1],[29,17,29,51,1],[30,17,30,48,1],[31,17,31,55,1],[33,17,33,70,1],[34,17,34,86,1],[36,17,36,37,1],[37,13,37,14,1],[39,13,39,32,1],[40,13,40,28,1],[41,9,41,10,1],[44,9,44,10,1],[45,13,45,42,1],[46,13,46,74,1],[47,13,47,31,1],[48,13,48,78,1],[49,13,49,69,1],[50,13,50,85,1],[51,13,51,56,1],[52,13,52,34,1],[53,13,53,14,1],[54,17,54,48,1],[56,17,56,36,1],[58,13,58,14,1],[60,13,60,32,1],[61,13,61,32,1],[62,9,62,10,1],[71,9,71,10,1],[72,13,72,74,1],[73,13,73,31,1],[74,13,74,60,1],[75,13,75,80,1],[76,13,76,69,1],[77,13,77,73,1],[78,13,78,56,1],[79,13,79,34,1],[80,13,80,14,1],[81,17,81,51,1],[82,17,82,58,1],[83,17,83,51,1],[84,17,84,55,1],[86,17,86,104,1],[87,17,87,45,1],[88,13,88,14,1],[90,13,90,32,1],[91,13,91,32,1],[92,9,92,10,1],[102,9,102,10,1],[103,13,103,74,1],[104,13,104,31,1],[105,13,105,48,1],[106,13,106,74,1],[107,13,107,69,1],[108,13,108,73,1],[109,13,109,56,1],[110,13,110,34,1],[111,13,111,14,1],[112,17,112,51,1],[113,17,113,53,1],[114,17,114,59,1],[116,17,116,88,1],[117,17,117,39,1],[118,13,118,14,1],[120,13,120,32,1],[121,13,121,26,1],[122,9,122,10,1],[132,9,132,10,1],[133,13,133,74,1],[134,13,134,31,1],[135,13,135,43,1],[136,13,136,73,1],[137,13,137,69,1],[138,13,138,73,1],[139,13,139,56,1],[140,13,140,34,1],[141,13,141,14,1],[142,17,142,51,1],[143,17,143,35,1],[144,13,144,14,1],[146,13,146,32,1],[147,13,147,25,1],[148,9,148,10,1]]);
    </script>
  </body>
</html>