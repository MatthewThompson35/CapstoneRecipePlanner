<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\matth\Desktop\capstone\CapstoneRecipePlanner\code\RecipePlannerApplication\RecipePlannerTests\IngredientDalTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using MySql.Data.MySqlClient;
using RecipePlannerLibrary;

namespace RecipePlannerTests
{
    [TestClass]
    public class IngredientDalTests
    {
        [TestMethod]
        public void TestGetIngredientsWithName()
        {
            ActiveUser.username = &quot;global&quot;;
            List&lt;Ingredient&gt; actualIngredients = IngredientDAL.getIngredients(&quot;cheese&quot;);

            Assert.AreEqual(true, actualIngredients.Count &gt; 0);
        }

        [TestMethod]
        public void TestGetIngredients()
        {
            ActiveUser.username = &quot;global&quot;;
            List&lt;Ingredient&gt; actualIngredients = IngredientDAL.getIngredients();

            Assert.AreEqual(true, actualIngredients.Count &gt; 0);
        }


        [TestMethod]
        public void DecrementQuantity()
        {

            ActiveUser.username = &quot;global&quot;;
            var list = IngredientDAL.getIngredients();
            var expectedQuantity = list[0].quantity - 1;
            IngredientDAL.decrementQuantity((int) list[0].id, (int) list[0].quantity);
            list = IngredientDAL.getIngredients();
            Assert.IsNotNull(list[0]);
            Assert.AreEqual(list[0].quantity, expectedQuantity);
        }

        [TestMethod]
        public void IncrementQuantity()
        {

            ActiveUser.username = &quot;global&quot;;
            var list = IngredientDAL.getIngredients();
            var expectedQuantity = list[0].quantity + 1;
            IngredientDAL.incrementQuantity((int) list[0].id, (int) list[0].quantity);
            list = IngredientDAL.getIngredients();
            Assert.IsNotNull(list[0]);
            Assert.AreEqual(list[0].quantity, expectedQuantity);
        }

        [TestMethod]
        public void TestRemoveIngredient()
        {

            int ingredientId = 900;

            IngredientDAL.RemoveIngredient(ingredientId);
            ActiveUser.username = &quot;global&quot;;
            var ingredients = IngredientDAL.getIngredients();
            Ingredient ingredient = null;
            foreach (var item in ingredients)
            {
                if (item.id == 900)
                {
                    ingredient = item;
                }
            }

            Assert.IsNull(ingredient);
        }

        [TestMethod]
        public void TestAddIngredient()
        {
            ActiveUser.username = &quot;global&quot;;

            string name = &quot;Flour&quot;;
            int quantity = 2;
            string measurement = &quot;G&quot;;

            IngredientDAL.addIngredient(name, quantity, measurement, Connection.TestsConnectionString);

            using var connection = new MySqlConnection(Connection.TestsConnectionString);
            connection.Open();
            var query = @&quot;Select * from ingredient where username = @username and ingredientName = @name&quot;;
            using var command = new MySqlCommand(query, connection);
            command.Parameters.AddWithValue(&quot;@username&quot;, ActiveUser.username);
            command.Parameters.AddWithValue(&quot;@name&quot;, name);
            using var reader = command.ExecuteReader();
            
            Assert.IsTrue(reader.Read());
            Assert.AreEqual(quantity, reader.GetInt32(&quot;quantity&quot;));
            Assert.AreEqual(measurement, reader.GetString(&quot;Measurement&quot;));
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[11,9,11,10,1],[12,13,12,44,1],[13,13,13,89,1],[15,13,15,64,1],[16,9,16,10,1],[20,9,20,10,1],[21,13,21,44,1],[22,13,22,81,1],[24,13,24,64,1],[25,9,25,10,1],[30,9,30,10,1],[32,13,32,44,1],[33,13,33,55,1],[34,13,34,57,1],[35,13,35,87,1],[36,13,36,51,1],[37,13,37,39,1],[38,13,38,65,1],[39,9,39,10,1],[43,9,43,10,1],[45,13,45,44,1],[46,13,46,55,1],[47,13,47,57,1],[48,13,48,87,1],[49,13,49,51,1],[50,13,50,39,1],[51,13,51,65,1],[52,9,52,10,1],[56,9,56,10,1],[58,13,58,36,1],[60,13,60,58,1],[61,13,61,44,1],[62,13,62,62,1],[63,13,63,42,1],[64,13,64,20,1],[64,22,64,30,1],[64,31,64,33,1],[64,34,64,45,1],[65,13,65,14,1],[66,17,66,36,1],[67,17,67,18,0],[68,21,68,39,0],[69,17,69,18,0],[70,13,70,14,1],[72,13,72,39,1],[73,9,73,10,1],[77,9,77,10,1],[78,13,78,44,1],[80,13,80,35,1],[81,13,81,30,1],[82,13,82,38,1],[84,13,84,104,1],[86,13,86,90,1],[87,13,87,31,1],[88,13,88,107,1],[89,13,89,69,1],[90,13,90,79,1],[91,13,91,60,1],[92,13,92,56,1],[94,13,94,42,1],[95,13,95,68,1],[96,13,96,75,1],[97,9,97,10,1]]);
    </script>
  </body>
</html>