<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\matth\Desktop\Capstone\CapstoneRecipePlanner\CapstoneRecipePlanner\code\RecipePlannerApplication\RecipePlannerWebApplication\Controllers\HomeController.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Diagnostics;
using System.Text.RegularExpressions;
using Microsoft.AspNetCore.Mvc;
using RecipePlannerLibrary;
using RecipePlannerLibrary.Database;
using RecipePlannerLibrary.Models;
using RecipePlannerWebApplication.Models;

namespace RecipePlannerWebApplication.Controllers;

/// &lt;summary&gt;
///     Manages the data and functionality for HomeController
/// &lt;/summary&gt;
public class HomeController : Controller
{
    #region Data members

    private readonly ILogger&lt;HomeController&gt; _logger;

    #endregion

    #region Constructors

    /// &lt;summary&gt;
    ///     Creates a new instance of a HomeController object with the specified Logger object
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;logger&quot;&gt;&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    public HomeController(ILogger&lt;HomeController&gt; logger)
    {
        this._logger = logger;
    }

    #endregion

    #region Methods

    /// &lt;summary&gt;
    ///     Takes the User to the login page
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The Login Page&lt;/returns&gt;
    public IActionResult Index()
    {
        return View();
    }

    /// &lt;summary&gt;
    ///     Checks the login and goes to recipe page on successful login. Prompts for retry on failed login
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;ad&quot;&gt;The Login object containing user credentials&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;
    ///     The Recipe Page view on successful login, Login Page view with error message on failed login or connection
    ///     error
    /// &lt;/returns&gt;
    [HttpPost]
    public IActionResult Index([Bind] Login ad)
    {
        try
        {
            var res = Database.LoginCheck(ad);
            if (res == 1)
            {
                ActiveUser.username = ad.Username;
                this.setupForRecipePage();
                return View(&quot;RecipePage&quot;);
            }

            ad.ErrorMessage = &quot;Incorrect username or password&quot;;
            return View(ad);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }
    }

    private void setupForRecipePage(int? page = 1)
    {
        try
        {
            List&lt;Recipe&gt; recipes = RecipeDAL.getRecipes(Connection.ConnectionString);

            foreach (var recipe in recipes)
            {
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            this.addToAvailableRecipes(recipes);
            const int pageSize = 10;
            var currentPage = page ?? 1;

            ViewBag.currentPage = currentPage;
            ViewBag.AvailableRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            ViewBag.AllRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            int totalAvailableRecipes = ViewBag.AvailableRecipes.Count;
            var totalAvailablePages = (int) Math.Ceiling((double) totalAvailableRecipes / pageSize);
            ViewBag.totalAvailablePages = totalAvailablePages;
            ViewBag.totalPages = (int) Math.Ceiling((double) recipes.Count / pageSize);
            ;
            List&lt;Recipe&gt; availableRecipes = ViewBag.AvailableRecipes;
            List&lt;Recipe&gt; allRecipes = ViewBag.AllRecipes;
            var currentAllPage = 1;

            var AvailableRecipesOnPage = availableRecipes
                .Skip((currentPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.availableRecipesOnPage = AvailableRecipesOnPage;

            var AllRecipesOnPage = allRecipes
                .Skip((currentAllPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.AllRecipesOnPage = AllRecipesOnPage;
            ViewBag.CurrentSelectedRadio = &quot;available&quot;;
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    private void setupForSharedRecipePage(int? page = 1)
    {
        try
        {
            List&lt;SharedRecipe&gt; sharedRecipes = RecipeDAL.getSharedRecipes(Connection.ConnectionString);
            var recipes = new List&lt;Recipe&gt;();

            foreach (var sharedRecipe in sharedRecipes)
            {
                var recipe = sharedRecipe.Recipe;

                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            this.addToAvailableRecipes(recipes);
            const int pageSize = 10;
            var currentPage = page ?? 1;

            ViewBag.currentPage = currentPage;
            ViewBag.AvailableRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            ViewBag.AllRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            int totalAvailableRecipes = ViewBag.AvailableRecipes.Count;
            var totalAvailablePages = (int) Math.Ceiling((double) totalAvailableRecipes / pageSize);
            ViewBag.totalAvailablePages = totalAvailablePages;
            ViewBag.totalPages = (int) Math.Ceiling((double) recipes.Count / pageSize);
            ;
            List&lt;Recipe&gt; availableRecipes = ViewBag.AvailableRecipes;
            List&lt;Recipe&gt; allRecipes = ViewBag.AllRecipes;
            var currentAllPage = 1;

            var AvailableRecipesOnPage = sharedRecipes
                .Skip((currentPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.availableRecipesOnPage = AvailableRecipesOnPage;

            var AllRecipesOnPage = sharedRecipes
                .Skip((currentAllPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.AllSharedRecipesOnPage = AllRecipesOnPage;
            ViewBag.AllRecipes = sharedRecipes;
            ViewBag.currentAllPage = currentPage;
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    /// &lt;summary&gt;
    ///     Adds to the available recipes if the user can make that recipe.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;
    ///     If there are available recipes in the database, ViewBag.AvailableRecipes.Count = the amount of recipes
    ///     available
    /// &lt;/postcondition&gt;
    /// &lt;param name=&quot;recipes&quot;&gt;The recipes.&lt;/param&gt;
    private void addToAvailableRecipes(List&lt;Recipe&gt; recipes)
    {
        try
        {
            ViewBag.AvailableRecipes = new List&lt;Recipe&gt;();
            ViewBag.AllRecipes = recipes;
            foreach (var recipe in ViewBag.AllRecipes)
            {
                var add = true;
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                foreach (RecipeIngredient ingredient in recipe.Ingredients)
                {
                    var ing = IngredientDAL.getIngredients(ingredient.IngredientName);
                    if (ing != null &amp;&amp; ing.Count &gt; 0)
                    {
                        if (ing[0].quantity &lt; ingredient.Quantity)
                        {
                            add = false;
                        }
                    }
                    else
                    {
                        add = false;
                    }
                }

                if (add)
                {
                    ViewBag.AvailableRecipes.Add(recipe);
                }
            }
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    /// &lt;summary&gt;
    ///     Compares the name of the recipes so that it can be sorted alphabetically.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipe1&quot;&gt;The recipe1.&lt;/param&gt;
    /// &lt;param name=&quot;recipe2&quot;&gt;The recipe2.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt; 0 or 1 based on which recipe name comes first&lt;/returns&gt;
    private int CompareRecipesByName(Recipe recipe1, Recipe recipe2)
    {
        return recipe1.Name.CompareTo(recipe2.Name);
    }

    /// &lt;summary&gt;
    ///     Decrements the quantity of a given ingredient by its id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to decrement quantity for.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Ingredient quantity is decremented in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The view of the ingredients page.&lt;/returns&gt;
    public ActionResult decrementQuantity(string id, int page)
    {
        try
        {
            ViewBag.ingredients = IngredientDAL.getIngredients();
            var quantity = 0;
            var ingredientID = int.Parse(id);

            quantity = this.getItemQuantity(ingredientID);
            if (quantity &gt; 1)
            {
                IngredientDAL.decrementQuantity(ingredientID, quantity);
            }
            else
            {
                IngredientDAL.RemoveIngredient(ingredientID, Connection.ConnectionString);
            }

            this.setupIngredientsPage(page);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Adds the needed planned meal ingredients to the shopping list.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;shopping list has needed planned meal ingredients&lt;/postcondition&gt;
    /// &lt;returns&gt;Shopping List page or login page on connection error&lt;/returns&gt;
    public ActionResult addNeededPlannedMealIngredients()
    {
        try
        {
            var allIngredientsPresent = true;
            var user = ActiveUser.username;
            var totalIngredients = new List&lt;Ingredient&gt;();
            var remainingMeals =
                PlannedMealDal.getRemainingMeals(Connection.ConnectionString);
            List&lt;Ingredient&gt; pantry = IngredientDAL.getIngredients();
            List&lt;Ingredient&gt; shoppingList = ShoppingListDAL.getIngredients(Connection.ConnectionString);

            foreach (var shoppingItem in shoppingList)
            {
                var pantryItem = pantry.Find(i =&gt; i.name == shoppingItem.name);

                if (pantryItem != null)
                {
                    pantryItem.quantity += shoppingItem.quantity;
                }
                else
                {
                    pantry.Add(shoppingItem);
                }
            }

            foreach (var recipeId in remainingMeals)
            {
                var recipeIngredients = RecipeDAL.getIngredientsForRecipe(recipeId, Connection.ConnectionString);

                foreach (var ingredient in recipeIngredients)
                {
                    var existingIngredient = totalIngredients.Find(i =&gt;
                        i.name == ingredient.IngredientName &amp;&amp; i.measurement == ingredient.Measurement);

                    if (existingIngredient != null)
                    {
                        existingIngredient.quantity += ingredient.Quantity;
                    }
                    else
                    {
                        var id = IngredientDAL.getIngredientId(ingredient.IngredientName);
                        var addIngredient = new Ingredient(user, ingredient.IngredientName, ingredient.Quantity,
                            id,
                            ingredient.Measurement);
                        totalIngredients.Add(addIngredient);
                    }
                }
            }

            foreach (var ingredient in totalIngredients)
            {
                var pantryItem = pantry.Find(i =&gt; i.name == ingredient.name);

                if (pantryItem != null)
                {
                    if (ingredient.quantity &gt; pantryItem.quantity)
                    {
                        var quantity = (int) ingredient.quantity - (int) pantryItem.quantity;
                        var shoppingListItem = shoppingList.Find(i =&gt; i.name == ingredient.name);

                        if (shoppingListItem != null)
                        {
                            allIngredientsPresent = false;
                            ShoppingListDAL.updateQuantity((int) ingredient.id, quantity, Connection.ConnectionString);
                        }
                        else
                        {
                            allIngredientsPresent = false;
                            ShoppingListDAL.addIngredient(ingredient.name, quantity, ingredient.measurement,
                                Connection.ConnectionString);
                        }
                    }
                }
                else
                {
                    allIngredientsPresent = false;
                    ShoppingListDAL.addIngredient(ingredient.name, (int) ingredient.quantity, ingredient.measurement,
                        Connection.ConnectionString);
                }
            }

            if (allIngredientsPresent)
            {
                ViewBag.error = &quot;There are no ingredients needed&quot;;
                this.setupPlannedMeals();
                return View(&quot;PlannedMealsPage&quot;);
            }

            this.setupShoppingListPage(1);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Adds all planned meal ingredients to the shopping list.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;All planned meal ingredients are in shopping list&lt;/postcondition&gt;
    /// &lt;returns&gt;Shopping List page or login page on connection error&lt;/returns&gt;
    public ActionResult addAllPlannedMealIngredients()
    {
        try
        {
            var user = ActiveUser.username;
            var totalIngredients = new List&lt;Ingredient&gt;();
            var remainingMeals =
                PlannedMealDal.getRemainingMeals(Connection.ConnectionString);
            List&lt;Ingredient&gt; pantry = IngredientDAL.getIngredients();
            List&lt;Ingredient&gt; shoppingList = ShoppingListDAL.getIngredients(Connection.ConnectionString);

            foreach (var shoppingItem in shoppingList)
            {
                var pantryItem = pantry.Find(i =&gt; i.name == shoppingItem.name);

                if (pantryItem != null)
                {
                    pantryItem.quantity += shoppingItem.quantity;
                }
                else
                {
                    pantry.Add(shoppingItem);
                }
            }

            foreach (var recipeId in remainingMeals)
            {
                var recipeIngredients = RecipeDAL.getIngredientsForRecipe(recipeId, Connection.ConnectionString);

                foreach (var ingredient in recipeIngredients)
                {
                    var existingIngredient = totalIngredients.Find(i =&gt;
                        i.name == ingredient.IngredientName &amp;&amp; i.measurement == ingredient.Measurement);

                    if (existingIngredient != null)
                    {
                        existingIngredient.quantity += ingredient.Quantity;
                    }
                    else
                    {
                        var id = IngredientDAL.getIngredientId(ingredient.IngredientName);
                        var addIngredient = new Ingredient(user, ingredient.IngredientName, ingredient.Quantity,
                            id,
                            ingredient.Measurement);
                        totalIngredients.Add(addIngredient);
                    }
                }
            }

            foreach (var ingredient in totalIngredients)
            {
                var shoppingListItem = shoppingList.Find(i =&gt; i.name == ingredient.name);

                if (shoppingListItem != null)
                {
                    var quantity = (int) shoppingListItem.quantity + (int) ingredient.quantity;
                    ShoppingListDAL.updateQuantity((int) ingredient.id, quantity, Connection.ConnectionString);
                }
                else
                {
                    ShoppingListDAL.addIngredient(ingredient.name, (int) ingredient.quantity, ingredient.measurement,
                        Connection.ConnectionString);
                }
            }

            this.setupShoppingListPage(1);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Decrements the quantity of a given shopping list ingredient by its id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to decrement quantity for.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Ingredient quantity is decremented in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The view of the shopping list page.&lt;/returns&gt;
    public ActionResult decrementShoppingListQuantity(string id, int page)
    {
        try
        {
            var quantity = 0;
            var ingredientID = int.Parse(id);

            quantity = this.getShoppingListItemQuantity(ingredientID);
            if (quantity &gt; 1)
            {
                ShoppingListDAL.decrementQuantity(ingredientID, quantity, Connection.ConnectionString);
            }
            else
            {
                ShoppingListDAL.RemoveIngredient(ingredientID, Connection.ConnectionString);
            }

            this.setupShoppingListPage(page);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Adds the recipe to the database.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeName&quot;&gt;Name of the recipe.&lt;/param&gt;
    /// &lt;param name=&quot;description&quot;&gt;The description.&lt;/param&gt;
    /// &lt;param name=&quot;steps&quot;&gt;The steps.&lt;/param&gt;
    /// &lt;param name=&quot;ingredients&quot;&gt;The ingredients.&lt;/param&gt;
    /// &lt;param name=&quot;tags&quot;&gt;The tags.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;recipe is added to the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The Recipe Page or the login page on database error&lt;/returns&gt;
    [HttpPost]
    public ActionResult AddRecipe(string recipeName, string description, string steps, string ingredients, string tags)
    {
        try
        {
            var exists = RecipeDAL.getRecipeByName(recipeName, Connection.ConnectionString);
            if (exists.Name == null)
            {
                RecipeDAL.addRecipe(recipeName, description, Connection.ConnectionString);

                var recipeSteps = new List&lt;RecipeStep&gt;();
                var recipeIngredients = new List&lt;RecipeIngredient&gt;();
                var recipeTags = new List&lt;string&gt;();
                var tagsList = new List&lt;string&gt;();
                var tagsSubstrings = tags.Split(&#39;:&#39;);
                foreach (var substring in tagsSubstrings)
                {
                    tagsList.Add(substring);
                }

                foreach (var tag in tagsList)
                {
                    var tagsStrings = tag.Split(&#39;,&#39;);
                    for (var i = 0; i &lt; 1; i++)
                    {
                        var Rtag = tagsStrings[0];
                        recipeTags.Add(Rtag);
                    }
                }

                var stepsList = new List&lt;string&gt;();
                var stepsSubstrings = steps.Split(&#39;:&#39;);
                foreach (var substring in stepsSubstrings)
                {
                    stepsList.Add(substring);
                }

                foreach (var step in stepsList)
                {
                    var stepsStrings = step.Split(&#39;,&#39;);
                    for (var i = 0; i &lt; 1; i++)
                    {
                        var Rstep =
                            new RecipeStep(RecipeDAL.getRecipeByName(recipeName, Connection.ConnectionString).RecipeId,
                                int.Parse(stepsStrings[0]), stepsStrings[1]);
                        recipeSteps.Add(Rstep);
                    }
                }

                var ingredientsList = new List&lt;string&gt;();
                var ingredientsSubstrings = ingredients.Split(&#39;:&#39;);
                foreach (var substring in ingredientsSubstrings)
                {
                    ingredientsList.Add(substring);
                }

                foreach (var ing in ingredientsList)
                {
                    var IngStrings = ing.Split(&#39;,&#39;);
                    for (var i = 0; i &lt; 1; i++)
                    {
                        var name = IngStrings[0];
                        var quantity = IngStrings[1];
                        var measurement = IngStrings[2];
                        var Ring = new RecipeIngredient(
                            RecipeDAL.getRecipeByName(recipeName, Connection.ConnectionString).RecipeId, IngStrings[0],
                            int.Parse(IngStrings[1]), IngStrings[2]);
                        recipeIngredients.Add(Ring);
                    }
                }

                foreach (var tag in recipeTags)
                {
                    RecipeDAL.addRecipeTag(RecipeDAL.getRecipeByName(recipeName, Connection.ConnectionString).RecipeId,
                        tag, Connection.ConnectionString);
                }

                foreach (var step in recipeSteps)
                {
                    RecipeDAL.addRecipeStep((int) step.recipeId, step.stepNumber, step.stepDescription,
                        Connection.ConnectionString);
                }

                foreach (var ing in recipeIngredients)
                {
                    RecipeDAL.addRecipeIngredient(ing.RecipeId, ing.IngredientName,
                        IngredientDAL.getIngredientId(ing.IngredientName), ing.Quantity, ing.Measurement,
                        Connection.ConnectionString);
                }
                this.setupForRecipePage();
                return View(&quot;RecipePage&quot;);
            }

            ViewBag.test = 1;
            var measurements = Enum.GetNames(typeof(Measurement)).ToList();
            ViewBag.Measurements = measurements;
            ViewBag.error = &quot;Recipe with name was already added&quot;;
            ViewBag.page = &quot;pantry&quot;;
            return View(&quot;AddRecipesPage&quot;, ViewBag.Measurements);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    /// Checks to see if the recipe exists.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeName&quot;&gt;Name of the recipe.&lt;/param&gt;
    /// &lt;returns&gt;True or false&lt;/returns&gt;
    public ActionResult CheckRecipeExists(string recipeName)
    {

        bool exists = false;
        var recipe = RecipeDAL.getRecipeByName(recipeName, Connection.ConnectionString);
        if (recipe.Name != null)
        {
            exists = true;
        }

        return Json(new { Exists = exists});
    }

    /// &lt;summary&gt;
    ///     Gets the quantity of the ingredient with the given id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The ingredient id.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The quantity of the ingredient&lt;/returns&gt;
    private int getItemQuantity(int id)
    {
        List&lt;Ingredient&gt; pantry = IngredientDAL.getIngredients();
        var quantity = 0;
        foreach (var item in pantry)
        {
            if (item.id == id)
            {
                quantity = (int) item.quantity;
            }
        }

        return quantity;
    }

    /// &lt;summary&gt;
    ///     Gets the quantity of the shopping list ingredient with the given id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The ingredient id.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The quantity of the ingredient&lt;/returns&gt;
    private int getShoppingListItemQuantity(int id)
    {
        List&lt;Ingredient&gt; shoppingList = ShoppingListDAL.getIngredients(Connection.ConnectionString);
        var quantity = 0;
        foreach (var item in shoppingList)
        {
            if (item.id == id)
            {
                quantity = (int) item.quantity;
            }
        }

        return quantity;
    }

    /// &lt;summary&gt;
    ///     Increments the quantity of the ingredient with the given id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to increment quantity for.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Quantity will be incremented in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The ingredients page or login on server connection error&lt;/returns&gt;
    public ActionResult incrementQuantity(string id, int page)
    {
        try
        {
            ViewBag.ingredients = IngredientDAL.getIngredients();
            var quantity = 0;
            var ingredientID = int.Parse(id);

            quantity = this.getItemQuantity(ingredientID);
            IngredientDAL.incrementQuantity(ingredientID, quantity);
            this.setupIngredientsPage(page);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Increments the quantity of the shopping list ingredient with the given id.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to increment quantity for.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Quantity will be incremented in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The shopping list page or login on server connection error&lt;/returns&gt;
    public ActionResult incrementShoppingListQuantity(string id, int page)
    {
        try
        {
            ViewBag.ingredients = IngredientDAL.getIngredients();
            var quantity = 0;
            var ingredientID = int.Parse(id);

            quantity = this.getShoppingListItemQuantity(ingredientID);
            ShoppingListDAL.incrementQuantity(ingredientID, quantity, Connection.ConnectionString);
            this.setupShoppingListPage(page);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Removes the ingredient from the list.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to remove.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Ingredient will be removed from the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The ingredients page or login on server connection error.&lt;/returns&gt;
    public ActionResult removeIngredient(string id, int page)
    {
        try
        {
            page = 1;
            IngredientDAL.RemoveIngredient(int.Parse(id), Connection.ConnectionString);
            this.setupIngredientsPage(page);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Removes the shopping list ingredient from the list.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;id&quot;&gt;The id of the ingredient to remove.&lt;/param&gt;
    /// &lt;param name=&quot;page&quot;&gt; The current page of the ingredient&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Ingredient will be removed from the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The shopping list page or login on server connection error.&lt;/returns&gt;
    public ActionResult removeShoppingListIngredient(string id, int page)
    {
        try
        {
            page = 1;
            ShoppingListDAL.RemoveIngredient(int.Parse(id), Connection.ConnectionString);
            this.setupShoppingListPage(page);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Adds the ingredient to the the database and is then displayed to the user.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;txtIngredientName&quot;&gt;The name of the ingredient.&lt;/param&gt;
    /// &lt;param name=&quot;txtQuantity&quot;&gt;The quantity of the ingredient.&lt;/param&gt;
    /// &lt;param name=&quot;measurement&quot;&gt;The measurement unit of the ingredient.&lt;/param&gt;
    /// &lt;precondition&gt;parameters must not be null, ingredient must not be in database.&lt;/precondition&gt;
    /// &lt;postcondition&gt;Ingredient is added to the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The ingredients page or login on server connection error.&lt;/returns&gt;
    [HttpPost]
    public ActionResult AddIngredient(string txtIngredientName, string txtQuantity, string measurement)
    {
        var measurements = Enum.GetNames(typeof(Measurement)).ToList();
        ViewBag.Measurements = measurements;
        var regex = new Regex(&quot;^[0-9]+$&quot;);
        try
        {
            if (txtIngredientName == null || txtQuantity == null || txtIngredientName == &quot;&quot; || txtQuantity == &quot;&quot;)
            {
                ViewBag.Error = &quot;Please enter values.&quot;;
                ViewBag.page = &quot;pantry&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }

            if (IngredientDAL.getIngredients(txtIngredientName).Count() &gt; 0)
            {
                ViewBag.Error = &quot;Ingredient is already entered.&quot;;
                ViewBag.page = &quot;pantry&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }

            if (!regex.Match(txtQuantity).Success)
            {
                ViewBag.Error = &quot;Quantity must be an integer.&quot;;
                ViewBag.page = &quot;pantry&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }

            IngredientDAL.addIngredient(txtIngredientName, int.Parse(txtQuantity), measurement,
                Connection.ConnectionString);
            var totalPages = (int) Math.Ceiling((double) IngredientDAL.getIngredients().Count / 5);
            this.setupIngredientsPage(totalPages);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Adds the shopping list ingredient to the the database and is then displayed to the user.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;txtIngredientName&quot;&gt;The name of the ingredient.&lt;/param&gt;
    /// &lt;param name=&quot;txtQuantity&quot;&gt;The quantity of the ingredient.&lt;/param&gt;
    /// &lt;param name=&quot;measurement&quot;&gt;The measurement unit of the ingredient.&lt;/param&gt;
    /// &lt;precondition&gt;parameters must not be null, ingredient must not be in database.&lt;/precondition&gt;
    /// &lt;postcondition&gt;Shopping listIngredient is added to the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The shopping list page or login on server connection error.&lt;/returns&gt;
    [HttpPost]
    public ActionResult AddShoppingListIngredient(string txtIngredientName, string txtQuantity, string measurement)
    {
        var measurements = Enum.GetNames(typeof(Measurement)).ToList();
        ViewBag.Measurements = measurements;
        var regex = new Regex(&quot;^[0-9]+$&quot;);
        try
        {
            if (txtIngredientName == null || txtQuantity == null || txtIngredientName == &quot;&quot; || txtQuantity == &quot;&quot;)
            {
                ViewBag.Error = &quot;Please enter values.&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }
            if (ShoppingListDAL.getIngredients(txtIngredientName, Connection.ConnectionString).Any())
            {
                ViewBag.Error = &quot;Ingredient is already entered.&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }

            if (!regex.Match(txtQuantity).Success)
            {
                ViewBag.Error = &quot;Quantity must be an integer.&quot;;
                return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
            }

            ShoppingListDAL.addIngredient(txtIngredientName, int.Parse(txtQuantity), measurement,
                Connection.ConnectionString);
            var totalPages = (int) Math.Ceiling((double) ShoppingListDAL.getIngredients(Connection.ConnectionString).Count / 5);
            this.setupShoppingListPage(totalPages);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Goes to ingredients page with specified page number.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;page&quot;&gt;The page number to navigate to.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;Returns the ingredients page with the specified page of ingredients.&lt;/returns&gt;
    public ActionResult goToIngredientsPage(int? page)
    {
        try
        {
            this.setupIngredientsPage(page);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }
    }

    /// &lt;summary&gt;
    ///     Goes to add recipes page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt; The add recipes page or login on connection error&lt;/returns&gt;
    public ActionResult goToAddRecipesPage()
    {
        try
        {
            ViewBag.test = 1;
            var measurements = Enum.GetNames(typeof(Measurement)).ToList();
            ViewBag.Measurements = measurements;
            ViewBag.page = &quot;pantry&quot;;
            return View(&quot;AddRecipesPage&quot;, ViewBag.Measurements);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }
    }

    /// &lt;summary&gt;
    ///     Goes to shopping list page with specified page number.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;page&quot;&gt;The page number to navigate to.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;Returns the shopping list page with the specified page of ingredients.&lt;/returns&gt;
    public ActionResult goToShoppingListPage(int? page)
    {
        try
        {
            this.setupShoppingListPage(page);
            return View(&quot;ShoppingList&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }
    }

    private void setupIngredientsPage(int? page)
    {
        const int pageSize = 5; // Change this to the desired page size
        var currentPage = page ?? 1;
        List&lt;Ingredient&gt; allIngredients = IngredientDAL.getIngredients();
        var totalIngredients = allIngredients.Count;
        var totalPages = (int) Math.Ceiling((double) totalIngredients / pageSize);

        var ingredientsOnPage = allIngredients
            .Skip((currentPage - 1) * pageSize)
            .Take(pageSize)
            .ToList();

        ViewBag.currentPage = currentPage;
        ViewBag.totalPages = totalPages;
        ViewBag.ingredientsOnPage = ingredientsOnPage;
    }

    private void setupShoppingListPage(int? page)
    {
        const int pageSize = 5;
        var currentPage = page ?? 1;
        List&lt;Ingredient&gt; allIngredients = IngredientDAL.GetIngredientsFromShoppingList();
        var totalIngredients = allIngredients.Count;
        var totalPages = (int) Math.Ceiling((double) totalIngredients / pageSize);

        var ingredientsOnPage = allIngredients
            .Skip((currentPage - 1) * pageSize)
            .Take(pageSize)
            .ToList();

        ViewBag.currentPage = currentPage;
        ViewBag.totalPages = totalPages;
        ViewBag.ingredientsOnPage = ingredientsOnPage;
    }

    /// &lt;summary&gt;
    ///     Goes to RecipesPage that displays the available recipes by default with the specified page number
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;page&quot;&gt;The page number to navigate to.&lt;/param&gt;
    /// &lt;precondition&gt;ViewBag.AvailableRecipes != null &lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The recipes page with the specified page or login on server connection error&lt;/returns&gt;
    public ActionResult goToRecipePage(int? page)
    {
        try
        {
            this.setupForRecipePage(page);
            if (ViewBag.AvailableRecipes == null)
            {
                TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
                return View(&quot;Index&quot;);
            }

            return View(&quot;RecipePage&quot;, ViewBag.AvailableRecipes);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Goes to RecipesPage that displays all recipes by default with the specified page number
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;ViewBag.AvailableRecipes != null&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The recipes page with the specified page or login on server connection error&lt;/returns&gt;
    public ActionResult goToRecipePageAll(int? page)
    {
        try
        {
            this.setupForRecipePageAll(page);
            if (ViewBag.AvailableRecipes == null)
            {
                TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
                return View(&quot;Index&quot;);
            }

            return View(&quot;RecipePage&quot;, ViewBag.AvailableRecipes);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    private void setupForRecipePageAll(int? page)
    {
        try
        {
            List&lt;Recipe&gt; recipes = RecipeDAL.getRecipes(Connection.ConnectionString);
            foreach (var recipe in recipes)
            {
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            var currentPage = 1;
            this.addToAvailableRecipes(recipes);
            const int pageSize = 10;
            var currentAllPage = page ?? 1;

            ViewBag.currentAllPage = currentAllPage;
            ViewBag.AvailableRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            ViewBag.AllRecipes.Sort((Comparison&lt;Recipe&gt;) this.CompareRecipesByName);
            int totalAvailableRecipes = ViewBag.AvailableRecipes.Count;
            var totalAvailablePages = (int) Math.Ceiling((double) totalAvailableRecipes / pageSize);
            ViewBag.totalAvailablePages = totalAvailablePages;
            ViewBag.totalPages = (int) Math.Ceiling((double) recipes.Count / pageSize);
            List&lt;Recipe&gt; availableRecipes = ViewBag.AvailableRecipes;
            List&lt;Recipe&gt; allRecipes = ViewBag.AllRecipes;

            var AvailableRecipesOnPage = availableRecipes
                .Skip((currentPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.availableRecipesOnPage = AvailableRecipesOnPage;

            var AllRecipesOnPage = allRecipes
                .Skip((currentAllPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.AllRecipesOnPage = AllRecipesOnPage;
            ViewBag.CurrentSelectedRadio = &quot;all&quot;;
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    /// &lt;summary&gt;
    ///     Goes to RecipesPage that displays all recipes by default with the specified page number
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;ViewBag.AvailableRecipes != null&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The recipes page with the specified page or login on server connection error&lt;/returns&gt;
    public ActionResult goToSharedRecipePageAll(int? page)
    {
        try
        {
            this.setupForSharedRecipePageAll(page);
            if (ViewBag.AvailableRecipes == null)
            {
                TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
                return View(&quot;Index&quot;);
            }

            return View(&quot;SharedRecipes&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    private void setupForSharedRecipePageAll(int? page)
    {
        try
        {
            List&lt;SharedRecipe&gt; sharedRecipes = RecipeDAL.getSharedRecipes(Connection.ConnectionString);
            var recipes = new List&lt;Recipe&gt;();

            foreach (var sharedRecipe in sharedRecipes)
            {
                var recipe = sharedRecipe.Recipe;
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            var currentPage = 1;
            this.addToAvailableRecipes(recipes);
            const int pageSize = 10;
            var currentSharedPage = page ?? 1;

            ViewBag.currentSharedPage = currentSharedPage;

            ViewBag.AllRecipes = sharedRecipes;
            ViewBag.totalPages = (int) Math.Ceiling((double) sharedRecipes.Count / pageSize);
            var allRecipes = sharedRecipes;

            var AllRecipesOnPage = allRecipes
                .Skip((currentSharedPage - 1) * pageSize)
                .Take(pageSize)
                .ToList();

            ViewBag.AllSharedRecipesOnPage = AllRecipesOnPage;
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    /// &lt;summary&gt;
    ///     Adds the planned meal with the specified data to the database.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeId&quot;&gt;The id for the recipe.&lt;/param&gt;
    /// &lt;param name=&quot;week&quot;&gt;The week of the meal.&lt;/param&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day of the meal.&lt;/param&gt;
    /// &lt;param name=&quot;type&quot;&gt;The meal type&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Meal is added to the specified slot in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The Recipe Page Defaulted to page one&lt;/returns&gt;
    public ActionResult addPlannedMeal(int recipeId, string week, string day, string type)
    {
        try
        {
            var recipeID = recipeId;
            var Week = week;
            var Day = day;
            var Type = type;
            DayOfWeek dayOfWeek;
            Enum.TryParse(day, out dayOfWeek);
            DateTime date;
            if (week.Equals(&quot;This Week&quot;))
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;this&quot;);
            }
            else
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;next&quot;);
            }

            if (PlannedMealDal.exists(Connection.ConnectionString, Type, date))
            {
                ViewBag.day = day;
                ViewBag.type = type;
                ViewBag.date = date;
                ViewBag.recipeId = recipeId;
                return View(&quot;OverwriteConformation&quot;);
            }

            PlannedMealDal.addPlannedMeal(Connection.ConnectionString, recipeId, day, type, date);
            this.setupForRecipePage();
            if (ViewBag.day == null)
            {
                ViewBag.day = &quot;Monday&quot;;
            }

            if (ViewBag.type == null)
            {
                ViewBag.type = &quot;Breakfast&quot;;
            }

            if (ViewBag.week == null)
            {
                ViewBag.week = &quot;This Week&quot;;
            }

            if (ViewBag.AvailableRecipes == null)
            {
                TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
                return View(&quot;Index&quot;);
            }
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;RecipePage&quot;, ViewBag.AvailableRecipes);
    }

    /// &lt;summary&gt;
    /// Adds the planned meal from planned meals page.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeId&quot;&gt;The recipe identifier.&lt;/param&gt;
    /// &lt;param name=&quot;week&quot;&gt;The week.&lt;/param&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day.&lt;/param&gt;
    /// &lt;param name=&quot;type&quot;&gt;The type.&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public ActionResult addPlannedMealPlannedMealsPage(int recipeId, string week, string day, string type)
    {
        try
        {
            var recipeID = recipeId;
            var Week = week;
            var Day = day;
            var Type = type;
            DayOfWeek dayOfWeek;
            Enum.TryParse(day, out dayOfWeek);
            DateTime date;
            if (week.Equals(&quot;This Week&quot;))
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;this&quot;);
            }
            else
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;next&quot;);
            }

            if (PlannedMealDal.exists(Connection.ConnectionString, Type, date))
            {
                ViewBag.day = day;
                ViewBag.type = type;
                ViewBag.date = date;
                ViewBag.recipeId = recipeId;
                return View(&quot;OverwriteConformation&quot;);
            }

            PlannedMealDal.addPlannedMeal(Connection.ConnectionString, recipeId, day, type, date);
            this.setupForRecipePage();
            if (ViewBag.day == null)
            {
                ViewBag.day = &quot;Monday&quot;;
            }

            if (ViewBag.type == null)
            {
                ViewBag.type = &quot;Breakfast&quot;;
            }

            if (ViewBag.week == null)
            {
                ViewBag.week = &quot;This Week&quot;;
            }

            if (ViewBag.AvailableRecipes == null)
            {
                TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
                return View(&quot;Index&quot;);
            }
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        this.setupPlannedMeals();
        return View(&quot;PlannedMealsPage&quot;);
    }

    /// &lt;summary&gt;
    ///     Overwrites the recipe for the specified day and meal type.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day of the week.&lt;/param&gt;
    /// &lt;param name=&quot;type&quot;&gt;The type of meal (e.g. breakfast, lunch, dinner).&lt;/param&gt;
    /// &lt;param name=&quot;date&quot;&gt;The date of the meal.&lt;/param&gt;
    /// &lt;param name=&quot;recipeId&quot;&gt;The ID of the recipe to use.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;Meal at specified time is overwritten in the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The recipes page or login on server connection error.&lt;/returns&gt;
    public ActionResult overwriteAddedMeal(string day, string type, string date, int recipeId)
    {
        var Date = DateTime.Parse(date);
        PlannedMealDal.UpdateThisWeeksMeal(Connection.ConnectionString, day, type, Date, recipeId);
        return this.goToRecipePage(1);
    }

    /// &lt;summary&gt;
    ///     Updates the planned meal for a given recipe on a specific week day.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeId&quot;&gt;The ID of the recipe to update.&lt;/param&gt;
    /// &lt;param name=&quot;week&quot;&gt;The week to update the planned meal for.&lt;/param&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day of the week to update the planned meal for.&lt;/param&gt;
    /// &lt;param name=&quot;type&quot;&gt;The type of meal to update (e.g. breakfast, lunch, dinner).&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;The meal is updated in the database to match the correct values&lt;/postcondition&gt;
    /// &lt;returns&gt;The updated recipes page or login on server connection error.&lt;/returns&gt;
    public ActionResult UpdateThisWeeksMeal(int recipeId, string week, string day, string type)
    {
        var recipeID = recipeId;
        var Week = week;
        var Day = day;
        var Type = type;
        DayOfWeek dayOfWeek;
        Enum.TryParse(day, out dayOfWeek);
        DateTime date;
        if (week.Equals(&quot;This Week&quot;))
        {
            date = Util.GetDateOfWeekDay(dayOfWeek, &quot;this&quot;);
        }
        else
        {
            date = Util.GetDateOfWeekDay(dayOfWeek, &quot;next&quot;);
        }

        PlannedMealDal.UpdateThisWeeksMeal(Connection.ConnectionString, Day, Type, date, recipeID);
        this.setupForRecipePage();
        if (ViewBag.AvailableRecipes == null)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }

        return View(&quot;RecipePage&quot;, ViewBag.AvailableRecipes);
    }

    /// &lt;summary&gt;
    ///     Goes to add ingredients page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The add ingredients page or login on bad server connection&lt;/returns&gt;
    public ActionResult goToAddIngredientsPage()
    {
        try
        {
            var measurements = Enum.GetNames(typeof(Measurement)).ToList();
            ViewBag.Measurements = measurements;
            ViewBag.page = &quot;pantry&quot;;
            return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Goes to add ingredients page for shopping list.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The add ingredients page or login on bad server connection&lt;/returns&gt;
    public ActionResult goToAddShoppingListIngredientsPage()
    {
        try
        {
            var measurements = Enum.GetNames(typeof(Measurement)).ToList();
            ViewBag.Measurements = measurements;
            ViewBag.page = &quot;shopping&quot;;
            return View(&quot;AddIngredient&quot;, ViewBag.Measurements);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Goes to shared recipes page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The shared recipes page or login on bad server connection&lt;/returns&gt;
    public ActionResult goToSharedRecipesPage()
    {
        try
        {
            this.setupForSharedRecipePage();
            return View(&quot;SharedRecipes&quot;, ViewBag.Measurements);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Toggles the week for Planned Meals page.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;currentWeek&quot;&gt;The current week. (This week or next week)&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The planned meals page based on which week is given&lt;/returns&gt;
    public ActionResult ToggleWeek(string currentWeek)
    {
        try
        {
            if (currentWeek.Equals(&quot;Next Week&quot;))
            {
                this.goToPlannedMealsPage();
            }
            else
            {
                this.goToPlannedMealsPageNextWeek();
            }

            return View(&quot;PlannedMealsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Gets the name of the recipe at the specified planned meal slot.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day.&lt;/param&gt;
    /// &lt;param name=&quot;mealType&quot;&gt;Type of the meal.&lt;/param&gt;
    /// &lt;param name=&quot;week&quot;&gt;The week.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;The planned meal slot will be updated with the recipe name&lt;/postcondition&gt;
    /// &lt;returns&gt;The recipeName and RecipeId as a json Result&lt;/returns&gt;
    public JsonResult GetRecipeName(string day, string mealType, string week)
    {
        try
        {
            var ThisWeeksMeals = new Dictionary&lt;(string, string), int&gt;();
            if (week.Equals(&quot;Next Week&quot;))
            {
                ThisWeeksMeals = PlannedMealDal.getNextWeeksMeals(Connection.ConnectionString);
            }
            else
            {
                ThisWeeksMeals = PlannedMealDal.getThisWeeksMeals(Connection.ConnectionString);
            }

            var recipeId = ThisWeeksMeals[(day, mealType)];
            var allRecipes = RecipeDAL.getRecipes(Connection.ConnectionString);
            var recipeName = &quot;&quot;;
            foreach (var recipe in allRecipes)
            {
                if (recipe.RecipeId == recipeId)
                {
                    recipeName = recipe.Name;
                }
            }

            ViewBag.Header = &quot;This weeks meals&quot;;
            return Json(new {RecipeId = recipeId, RecipeName = recipeName});
        }
        catch (Exception ex)
        {
            var recipeId = &quot;You have not yet added a meal for this time&quot;;
            return Json(new {RecipeId = recipeId, RecipeName = &quot;You Have not yet added a meal for this time&quot;});
        }
    }

    /// &lt;summary&gt;
    ///     Removes the meal at the specified planned meal slot.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;day&quot;&gt;The day.&lt;/param&gt;
    /// &lt;param name=&quot;mealType&quot;&gt;Type of the meal.&lt;/param&gt;
    /// &lt;param name=&quot;week&quot;&gt;The week.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;The planned meal is removed from the database&lt;/postcondition&gt;
    /// &lt;returns&gt;Returns a Json Result that gives the string that is updated in place of the removed recipe&lt;/returns&gt;
    public JsonResult RemoveThisWeeksMeal(string day, string mealType, string week)
    {
        try
        {
            var ThisWeeksMeals = new Dictionary&lt;(string, string), int&gt;();
            if (week.Equals(&quot;Next Week&quot;))
            {
                ThisWeeksMeals = PlannedMealDal.getNextWeeksMeals(Connection.ConnectionString);
            }
            else
            {
                ThisWeeksMeals = PlannedMealDal.getThisWeeksMeals(Connection.ConnectionString);
            }

            var recipeId = ThisWeeksMeals[(day, mealType)];
            DayOfWeek dayOfWeek;
            Enum.TryParse(day, out dayOfWeek);
            DateTime date;
            if (week.Equals(&quot;Next Week&quot;))
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;next&quot;);
            }
            else
            {
                date = Util.GetDateOfWeekDay(dayOfWeek, &quot;this&quot;);
            }

            PlannedMealDal.RemoveThisWeekMeal(Connection.ConnectionString, recipeId, day, mealType, date);

            ViewBag.Header = &quot;This weeks meals&quot;;
            return Json(new {RecipeId = recipeId, RecipeName = &quot;You Have not yet added a meal for this time&quot;});
        }
        catch (Exception ex)
        {
            try
            {
                var ThisWeeksMeals = PlannedMealDal.getThisWeeksMeals(Connection.ConnectionString);
                var recipeId = ThisWeeksMeals[(day, mealType)];
                var allRecipes = RecipeDAL.getRecipes(Connection.ConnectionString);
                var recipeName = &quot;&quot;;
                foreach (var recipe in allRecipes)
                {
                    if (recipe.RecipeId == recipeId)
                    {
                        recipeName = recipe.Name;
                    }
                }

                return Json(new {RecipeName = recipeName});
            }
            catch (Exception ex2)
            {
                return Json(new {RecipeName = &quot;You Have not yet added a meal for this time&quot;});
            }
        }
    }

    /// &lt;summary&gt;
    ///     Goes to planned meals page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The planned meals page or login on bad server connection&lt;/returns&gt;
    public ActionResult goToPlannedMealsPage()
    {
        try
        {
            ViewBag.CurrentWeek = &quot;This Week&quot;;
            List&lt;Recipe&gt; recipes = RecipeDAL.getRecipes(Connection.ConnectionString);
            foreach (var recipe in recipes)
            {
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            ViewBag.AllRecipes = recipes;
            var breakfast = new List&lt;string&gt;();
            var lunch = new List&lt;string&gt;();
            var dinner = new List&lt;string&gt;();
            var dictionary = PlannedMealDal.getThisWeeksMeals(Connection.ConnectionString);
            var daysOfWeek = new List&lt;string&gt;
                {&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;};
            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Breakfast&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                breakfast.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Lunch&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                lunch.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Dinner&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                dinner.Add(recipeName);
            }

            ViewBag.DefaultValues = breakfast;
            ViewBag.Lunch = lunch;
            ViewBag.Dinner = dinner;
            ViewBag.Header = &quot;This weeks meals&quot;;
            ViewBag.CurrentWeek = &quot;This Week&quot;;
            return View(&quot;PlannedMealsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }

        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
        ///     Purchases all shopping list and adds it to pantry.
        /// &lt;/summary&gt;
        /// &lt;precondition&gt;none&lt;/precondition&gt;
        /// &lt;postcondition&gt;Pantry is updated with shopping list values&lt;/postcondition&gt;
        /// &lt;returns&gt;Ingredients Page or login on bag connection&lt;/returns&gt;
        public ActionResult purchaseAllShoppingList()
    {
        try
        {
            List&lt;Ingredient&gt; list = ShoppingListDAL.getIngredients(Connection.ConnectionString);
            List&lt;Ingredient&gt; pantry = IngredientDAL.getIngredients();

            foreach (var ingredient in list)
            {
                var found = false;
                foreach (var pantryIngredient in pantry)
                {
                    if (pantryIngredient.id.Equals(ingredient.id))
                    {
                        var quantity = (int) pantryIngredient.quantity + (int) ingredient.quantity;
                        found = true;
                        IngredientDAL.updateQuantity((int) pantryIngredient.id, quantity);
                        break;
                    }
                }

                if (!found)
                {
                    IngredientDAL.addIngredient(ingredient.name, (int) ingredient.quantity, ingredient.measurement,
                        Connection.ConnectionString);
                }

                ShoppingListDAL.removeAll(Connection.ConnectionString);
            }

            this.setupIngredientsPage(1);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Index&quot;);
        }
    }

    private void setupPlannedMeals()
    {
        try
        {
            ViewBag.CurrentWeek = &quot;This Week&quot;;
            List&lt;Recipe&gt; recipes = RecipeDAL.getRecipes(Connection.ConnectionString);
            foreach (var recipe in recipes)
            {
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            ViewBag.AllRecipes = recipes;
            var breakfast = new List&lt;string&gt;();
            var lunch = new List&lt;string&gt;();
            var dinner = new List&lt;string&gt;();
            var dictionary = PlannedMealDal.getThisWeeksMeals(Connection.ConnectionString);
            var daysOfWeek = new List&lt;string&gt;
                {&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;};
            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Breakfast&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                breakfast.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Lunch&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                lunch.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Dinner&quot;, &quot;This Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                dinner.Add(recipeName);
            }

            ViewBag.DefaultValues = breakfast;
            ViewBag.Lunch = lunch;
            ViewBag.Dinner = dinner;
            ViewBag.Header = &quot;This weeks meals&quot;;
            ViewBag.CurrentWeek = &quot;This Week&quot;;
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
    }

    /// &lt;summary&gt;
    ///     Goes to next week&#39;s planned meal page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The next week&#39;s planned meal page or login on bad server connection&lt;/returns&gt;
    public ActionResult goToPlannedMealsPageNextWeek()
    {
        try
        {
            ViewBag.CurrentWeek = &quot;Next Week&quot;;
            List&lt;Recipe&gt; recipes = RecipeDAL.getRecipes(Connection.ConnectionString);
            foreach (var recipe in recipes)
            {
                recipe.Ingredients = RecipeDAL.getIngredientsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Steps = RecipeDAL.getStepsForRecipe(recipe.RecipeId, Connection.ConnectionString);
                recipe.Tags = RecipeDAL.getTagsForRecipe(recipe.RecipeId, Connection.ConnectionString);
            }

            ViewBag.AllRecipes = recipes;
            var breakfast = new List&lt;string&gt;();
            var daysOfWeek = new List&lt;string&gt;
                {&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;};
            var lunch = new List&lt;string&gt;();
            var dinner = new List&lt;string&gt;();
            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Breakfast&quot;, &quot;Next Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                breakfast.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Lunch&quot;, &quot;Next Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                lunch.Add(recipeName);
            }

            foreach (var day in daysOfWeek)
            {
                var json = this.GetRecipeName(day, &quot;Dinner&quot;, &quot;Next Week&quot;);
                var recipeName = (string) json.Value.GetType().GetProperty(&quot;RecipeName&quot;).GetValue(json.Value);
                dinner.Add(recipeName);
            }

            ViewBag.DefaultValues = breakfast;
            ViewBag.Lunch = lunch;
            ViewBag.Dinner = dinner;
            ViewBag.Header = &quot;Next weeks meals&quot;;
            ViewBag.CurrentWeek = &quot;Next Week&quot;;
            return View(&quot;PlannedMealsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Creates the user.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;username&quot;&gt;The username.&lt;/param&gt;
    /// &lt;param name=&quot;password&quot;&gt;The password.&lt;/param&gt;
    /// &lt;param name=&quot;repeatPassword&quot;&gt;The repeat password.&lt;/param&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;The user is added to the database&lt;/postcondition&gt;
    /// &lt;returns&gt;The login page or register is user was not added or login on server connection error&lt;/returns&gt;
    [HttpPost]
    public ActionResult CreateUser(string username, string password, string repeatPassword)
    {
        try
        {
            List&lt;string&gt; list = Database.ContainsUser(username);
            if (list.Count() &gt; 0)
            {
                ViewBag.Error = &quot;Username already exists. Please choose another and try again.&quot;;
                return View(&quot;Register&quot;);
            }

            if (username == null)
            {
                ViewBag.Error = &quot;Please enter a username&quot;;
                return View(&quot;Register&quot;);
            }

            if (password == null)
            {
                ViewBag.Error = &quot;Please enter a password&quot;;
                return View(&quot;Register&quot;);
            }

            if (repeatPassword == null)
            {
                ViewBag.Error = &quot;Please re-enter your password&quot;;
                return View(&quot;Register&quot;);
            }

            if (!password.Equals(repeatPassword))
            {
                ViewBag.Error = &quot;The passwords do not match&quot;;
                return View(&quot;Register&quot;);
            }

            if (password != null &amp;&amp; repeatPassword != null &amp;&amp; password.Equals(repeatPassword))
            {
                Database.CreateUser(username, password);
                return View(&quot;Index&quot;);
            }

            ViewBag.Error = &quot;Passwords do not match. Please try again.&quot;;
            return View(&quot;Register&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
            return View(&quot;Register&quot;);
        }

        return View(&quot;Register&quot;);
    }

    /// &lt;summary&gt;
    ///     Opens the register page.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt;The register page&lt;/returns&gt;
    [HttpPost]
    public ActionResult OpenRegister()
    {
        return View(&quot;Register&quot;);
    }

    /// &lt;summary&gt;
    ///     Errors this instance.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The view&lt;/returns&gt;
    [ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
    public IActionResult Error()
    {
        return View(new ErrorViewModel {RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier});
    }

    /// &lt;summary&gt;
    ///     Logs out of this instance.
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt; The login page&lt;/returns&gt;
    [HttpPost]
    public IActionResult Logout()
    {
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Marks recipe as cooked and removes ingredients from pantry
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt; The recipe page&lt;/returns&gt;
    [HttpPost]
    public IActionResult CookMeal(int recipeID)
    {
        try
        {
            var totalIngredients = IngredientDAL.getIngredients();
            foreach (var ingredient in
                     RecipeDAL.getIngredientsForRecipe(recipeID, Connection.ConnectionString))
            {
                var existingIngredient = totalIngredients.Find(i =&gt;
                    i.name == ingredient.IngredientName &amp;&amp; i.measurement == ingredient.Measurement);

                if (existingIngredient != null)
                {
                    if (existingIngredient.quantity - ingredient.Quantity &gt; 0)
                    {
                        IngredientDAL.updateQuantity((int) existingIngredient.id,
                            (int) existingIngredient.quantity - ingredient.Quantity);
                    }
                    else
                    {
                        IngredientDAL.RemoveIngredient((int) existingIngredient.id, Connection.ConnectionString);
                    }
                }
            }

            this.setupIngredientsPage(1);
            return View(&quot;IngredientsPage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    /// Takes you to cook meal confirmation.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;recipeID&quot;&gt;The recipe identifier.&lt;/param&gt;
    /// &lt;returns&gt;Cook meal confirmation page&lt;/returns&gt;
    [HttpPost]
    public IActionResult CookMealConfirmation(int recipeID)
    {
        try
        {
            ViewBag.id = recipeID;
            bool hasAllIngredients = true;

            var totalIngredients = IngredientDAL.getIngredients();
            foreach (var ingredient in
                     RecipeDAL.getIngredientsForRecipe(recipeID, Connection.ConnectionString))
            {
                var existingIngredient = totalIngredients.Find(i =&gt;
                    i.name == ingredient.IngredientName &amp;&amp; i.measurement == ingredient.Measurement);

                if (existingIngredient == null || existingIngredient.quantity - ingredient.Quantity &lt; 0)
                {
                    hasAllIngredients = false;
                }
            }

            if (hasAllIngredients)
            {
                return View(&quot;CookMealConfirmation&quot;);
            }

            return View(&quot;MissingIngredientsConfirmation&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    ///     Opens the share recipe form
    /// &lt;/summary&gt;
    /// &lt;precondition&gt;none&lt;/precondition&gt;
    /// &lt;postcondition&gt;none&lt;/postcondition&gt;
    /// &lt;returns&gt; The recipe page&lt;/returns&gt;
    [HttpPost]
    public IActionResult ShareMeal(int sharedRecipeID)
    {
        try
        {
            var username = Request.Form[&quot;txtUsername&quot;].ToString();
            var isValid = Database.ContainsUser(username).Count != 0;
            var recipe =
                new SharedRecipe(
                    RecipeDAL.getRecipeByName(RecipeDAL.getRecipeNameById(sharedRecipeID, Connection.ConnectionString),
                        Connection.ConnectionString), ActiveUser.username, username);
            if (RecipeDAL.ContainsSharedRecipe(recipe).Count &gt; 0)
            {
                ViewBag.ErrorMessage = &quot;You have already shared this recipe with &quot; + username;
                this.setupForRecipePage();
                return View(&quot;RecipePage&quot;);
            }

            if (isValid)
            {
                if (sharedRecipeID == 0)
                {
                    ViewBag.ErrorMessage = &quot;Please select a recipe and try again.&quot;;
                    this.setupForRecipePage();
                    return View(&quot;RecipePage&quot;);
                }

                ViewBag.ErrorMessage = &quot;&quot;;
                RecipeDAL.shareRecipe(username, sharedRecipeID, Connection.ConnectionString);
                TempData[&quot;SharedRecipeID&quot;] = sharedRecipeID;
                return RedirectToAction(&quot;RecipePage&quot;);
            }

            ViewBag.ErrorMessage = &quot;This is not a valid Username. Enter another and try again.&quot;;
            this.setupForRecipePage();
            return View(&quot;RecipePage&quot;);
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    /// &lt;summary&gt;
    /// Shows the recipe page with shared recipe.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The current recipe page&lt;/returns&gt;
    public IActionResult RecipePage()
    {
        try
        {
            var sharedRecipeID = 0;
            if (TempData[&quot;SharedRecipeID&quot;] != null)
            {
                sharedRecipeID = (int) TempData[&quot;SharedRecipeID&quot;];
            }

            List&lt;SharedRecipe&gt; allRecipes = RecipeDAL.getSharedRecipes(Connection.ConnectionString);
            var sharedRecipe = allRecipes.FirstOrDefault(r =&gt; r.Recipe.RecipeId == sharedRecipeID);
            ViewBag.AllRecipes = allRecipes;
            ViewBag.SharedRecipe = sharedRecipe;

            this.setupForRecipePage();
            return View();
        }
        catch (Exception ex)
        {
            TempData[&quot;msg&quot;] = &quot;The connection to the server could not be made&quot;;
        }
        return View(&quot;Index&quot;);
    }

    #endregion
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[30,5,30,58,0],[31,5,31,6,0],[32,9,32,31,0],[33,5,33,6,0],[46,5,46,6,0],[47,9,47,23,0],[48,5,48,6,0],[62,5,62,6,0],[64,9,64,10,0],[65,13,65,47,0],[66,13,66,26,0],[67,13,67,14,0],[68,17,68,51,0],[69,17,69,43,0],[70,17,70,43,0],[73,13,73,64,0],[74,13,74,29,0],[76,9,76,29,0],[77,9,77,10,0],[78,13,78,80,0],[79,13,79,34,0],[81,5,81,6,0],[84,5,84,6,0],[86,9,86,10,0],[87,13,87,86,0],[89,13,89,20,0],[89,22,89,32,0],[89,33,89,35,0],[89,36,89,43,0],[90,13,90,14,0],[91,17,91,118,0],[92,17,92,106,0],[93,17,93,104,0],[94,13,94,14,0],[96,13,96,49,0],[98,13,98,41,0],[100,13,100,47,0],[101,13,101,91,0],[102,13,102,85,0],[103,13,103,72,0],[104,13,104,101,0],[105,13,105,63,0],[106,13,106,88,0],[107,13,107,14,0],[108,13,108,70,0],[109,13,109,58,0],[110,13,110,36,0],[112,13,115,27,0],[117,13,117,69,0],[119,13,122,27,0],[124,13,124,57,0],[125,13,125,56,0],[126,9,126,10,0],[127,9,127,29,0],[128,9,128,10,0],[129,13,129,80,0],[130,9,130,10,0],[131,5,131,6,0],[134,5,134,6,0],[136,9,136,10,0],[137,13,137,104,0],[138,13,138,46,0],[140,13,140,20,0],[140,22,140,38,0],[140,39,140,41,0],[140,42,140,55,0],[141,13,141,14,0],[142,17,142,50,0],[144,17,144,118,0],[145,17,145,106,0],[146,17,146,104,0],[147,13,147,14,0],[149,13,149,49,0],[151,13,151,41,0],[153,13,153,47,0],[154,13,154,91,0],[155,13,155,85,0],[156,13,156,72,0],[157,13,157,101,0],[158,13,158,63,0],[159,13,159,88,0],[160,13,160,14,0],[161,13,161,70,0],[162,13,162,58,0],[163,13,163,36,0],[165,13,168,27,0],[170,13,170,69,0],[172,13,175,27,0],[177,13,177,63,0],[178,13,178,48,0],[179,13,179,50,0],[180,9,180,10,0],[181,9,181,29,0],[182,9,182,10,0],[183,13,183,80,0],[184,9,184,10,0],[185,5,185,6,0],[197,5,197,6,0],[199,9,199,10,0],[200,13,200,59,0],[201,13,201,42,0],[202,13,202,20,0],[202,22,202,32,0],[202,33,202,35,0],[202,36,202,54,0],[203,13,203,14,0],[204,17,204,32,0],[205,17,205,118,0],[206,17,206,24,0],[206,26,206,53,0],[206,54,206,56,0],[206,57,206,75,0],[207,17,207,18,0],[208,21,208,87,0],[209,21,209,54,0],[210,21,210,22,0],[211,25,211,67,0],[212,25,212,26,0],[213,29,213,41,0],[214,25,214,26,0],[215,21,215,22,0],[217,21,217,22,0],[218,25,218,37,0],[219,21,219,22,0],[220,17,220,18,0],[222,17,222,25,0],[223,17,223,18,0],[224,21,224,58,0],[225,17,225,18,0],[226,13,226,14,0],[227,9,227,10,0],[228,9,228,29,0],[229,9,229,10,0],[230,13,230,80,0],[231,9,231,10,0],[232,5,232,6,0],[243,5,243,6,0],[244,9,244,53,0],[245,5,245,6,0],[256,5,256,6,0],[258,9,258,10,0],[259,13,259,66,0],[260,13,260,30,0],[261,13,261,46,0],[263,13,263,59,0],[264,13,264,30,0],[265,13,265,14,0],[266,17,266,73,0],[267,13,267,14,0],[269,13,269,14,0],[270,17,270,91,0],[271,13,271,14,0],[273,13,273,45,0],[274,13,274,44,0],[276,9,276,29,0],[277,9,277,10,0],[278,13,278,80,0],[279,9,279,10,0],[281,9,281,30,0],[282,5,282,6,0],[291,5,291,6,0],[293,9,293,10,0],[294,13,294,46,0],[295,13,295,44,0],[296,13,296,59,0],[297,13,298,79,0],[299,13,299,70,0],[300,13,300,105,0],[302,13,302,20,0],[302,22,302,38,0],[302,39,302,41,0],[302,42,302,54,0],[303,13,303,14,0],[304,17,304,51,0],[304,51,304,78,0],[304,78,304,80,0],[306,17,306,40,0],[307,17,307,18,0],[308,21,308,66,0],[309,17,309,18,0],[311,17,311,18,0],[312,21,312,46,0],[313,17,313,18,0],[314,13,314,14,0],[316,13,316,20,0],[316,22,316,34,0],[316,35,316,37,0],[316,38,316,52,0],[317,13,317,14,0],[318,17,318,114,0],[320,17,320,24,0],[320,26,320,40,0],[320,41,320,43,0],[320,44,320,61,0],[321,17,321,18,0],[322,21,323,25,0],[323,25,323,103,0],[323,103,323,105,0],[325,21,325,52,0],[326,21,326,22,0],[327,25,327,76,0],[328,21,328,22,0],[330,21,330,22,0],[331,25,331,91,0],[332,25,334,53,0],[335,25,335,61,0],[336,21,336,22,0],[337,17,337,18,0],[338,13,338,14,0],[340,13,340,20,0],[340,22,340,36,0],[340,37,340,39,0],[340,40,340,56,0],[341,13,341,14,0],[342,17,342,51,0],[342,51,342,76,0],[342,76,342,78,0],[344,17,344,40,0],[345,17,345,18,0],[346,21,346,67,0],[347,21,347,22,0],[348,25,348,94,0],[349,25,349,71,0],[349,71,349,96,0],[349,96,349,98,0],[351,25,351,54,0],[352,25,352,26,0],[353,29,353,59,0],[354,29,354,120,0],[355,25,355,26,0],[357,25,357,26,0],[358,29,358,59,0],[359,29,360,62,0],[361,25,361,26,0],[362,21,362,22,0],[363,17,363,18,0],[365,17,365,18,0],[366,21,366,51,0],[367,21,368,54,0],[369,17,369,18,0],[370,13,370,14,0],[372,13,372,39,0],[373,13,373,14,0],[374,17,374,67,0],[375,17,375,42,0],[376,17,376,49,0],[379,13,379,43,0],[380,13,380,41,0],[382,9,382,29,0],[383,9,383,10,0],[384,13,384,80,0],[385,9,385,10,0],[387,9,387,30,0],[388,5,388,6,0],[397,5,397,6,0],[399,9,399,10,0],[400,13,400,44,0],[401,13,401,59,0],[402,13,403,79,0],[404,13,404,70,0],[405,13,405,105,0],[407,13,407,20,0],[407,22,407,38,0],[407,39,407,41,0],[407,42,407,54,0],[408,13,408,14,0],[409,17,409,51,0],[409,51,409,78,0],[409,78,409,80,0],[411,17,411,40,0],[412,17,412,18,0],[413,21,413,66,0],[414,17,414,18,0],[416,17,416,18,0],[417,21,417,46,0],[418,17,418,18,0],[419,13,419,14,0],[421,13,421,20,0],[421,22,421,34,0],[421,35,421,37,0],[421,38,421,52,0],[422,13,422,14,0],[423,17,423,114,0],[425,17,425,24,0],[425,26,425,40,0],[425,41,425,43,0],[425,44,425,61,0],[426,17,426,18,0],[427,21,428,25,0],[428,25,428,103,0],[428,103,428,105,0],[430,21,430,52,0],[431,21,431,22,0],[432,25,432,76,0],[433,21,433,22,0],[435,21,435,22,0],[436,25,436,91,0],[437,25,439,53,0],[440,25,440,61,0],[441,21,441,22,0],[442,17,442,18,0],[443,13,443,14,0],[445,13,445,20,0],[445,22,445,36,0],[445,37,445,39,0],[445,40,445,56,0],[446,13,446,14,0],[447,17,447,63,0],[447,63,447,88,0],[447,88,447,90,0],[449,17,449,46,0],[450,17,450,18,0],[451,21,451,96,0],[452,21,452,112,0],[453,17,453,18,0],[455,17,455,18,0],[456,21,457,54,0],[458,17,458,18,0],[459,13,459,14,0],[461,13,461,43,0],[462,13,462,41,0],[464,9,464,29,0],[465,9,465,10,0],[466,13,466,80,0],[467,9,467,10,0],[469,9,469,30,0],[470,5,470,6,0],[481,5,481,6,0],[483,9,483,10,0],[484,13,484,30,0],[485,13,485,46,0],[487,13,487,71,0],[488,13,488,30,0],[489,13,489,14,0],[490,17,490,104,0],[491,13,491,14,0],[493,13,493,14,0],[494,17,494,93,0],[495,13,495,14,0],[497,13,497,46,0],[498,13,498,41,0],[500,9,500,29,0],[501,9,501,10,0],[502,13,502,80,0],[503,9,503,10,0],[505,9,505,30,0],[506,5,506,6,0],[521,5,521,6,0],[523,9,523,10,0],[524,13,524,93,0],[525,13,525,37,0],[526,13,526,14,0],[527,17,527,91,0],[529,17,529,58,0],[530,17,530,70,0],[531,17,531,53,0],[532,17,532,51,0],[533,17,533,54,0],[534,17,534,24,0],[534,26,534,39,0],[534,40,534,42,0],[534,43,534,57,0],[535,17,535,18,0],[536,21,536,45,0],[537,17,537,18,0],[539,17,539,24,0],[539,26,539,33,0],[539,34,539,36,0],[539,37,539,45,0],[540,17,540,18,0],[541,21,541,54,0],[542,26,542,35,0],[542,37,542,42,0],[542,44,542,47,0],[543,21,543,22,0],[544,25,544,51,0],[545,25,545,46,0],[546,21,546,22,0],[547,17,547,18,0],[549,17,549,52,0],[550,17,550,56,0],[551,17,551,24,0],[551,26,551,39,0],[551,40,551,42,0],[551,43,551,58,0],[552,17,552,18,0],[553,21,553,46,0],[554,17,554,18,0],[556,17,556,24,0],[556,26,556,34,0],[556,35,556,37,0],[556,38,556,47,0],[557,17,557,18,0],[558,21,558,56,0],[559,26,559,35,0],[559,37,559,42,0],[559,44,559,47,0],[560,21,560,22,0],[561,25,563,78,0],[564,25,564,48,0],[565,21,565,22,0],[566,17,566,18,0],[568,17,568,58,0],[569,17,569,68,0],[570,17,570,24,0],[570,26,570,39,0],[570,40,570,42,0],[570,43,570,64,0],[571,17,571,18,0],[572,21,572,52,0],[573,17,573,18,0],[575,17,575,24,0],[575,26,575,33,0],[575,34,575,36,0],[575,37,575,52,0],[576,17,576,18,0],[577,21,577,53,0],[578,26,578,35,0],[578,37,578,42,0],[578,44,578,47,0],[579,21,579,22,0],[580,25,580,50,0],[581,25,581,54,0],[582,25,582,57,0],[583,25,585,70,0],[586,25,586,53,0],[587,21,587,22,0],[588,17,588,18,0],[590,17,590,24,0],[590,26,590,33,0],[590,34,590,36,0],[590,37,590,47,0],[591,17,591,18,0],[592,21,593,59,0],[594,17,594,18,0],[596,17,596,24,0],[596,26,596,34,0],[596,35,596,37,0],[596,38,596,49,0],[597,17,597,18,0],[598,21,599,54,0],[600,17,600,18,0],[602,17,602,24,0],[602,26,602,33,0],[602,34,602,36,0],[602,37,602,54,0],[603,17,603,18,0],[604,21,606,54,0],[607,17,607,18,0],[608,17,608,43,0],[609,17,609,43,0],[612,13,612,30,0],[613,13,613,76,0],[614,13,614,49,0],[615,13,615,66,0],[616,13,616,37,0],[617,13,617,65,0],[619,9,619,29,0],[620,9,620,10,0],[621,13,621,80,0],[622,9,622,10,0],[624,9,624,30,0],[625,5,625,6,0],[633,5,633,6,0],[635,9,635,29,0],[636,9,636,89,0],[637,9,637,33,0],[638,9,638,10,0],[639,13,639,27,0],[640,9,640,10,0],[642,9,642,45,0],[643,5,643,6,0],[653,5,653,6,0],[654,9,654,66,0],[655,9,655,26,0],[656,9,656,16,0],[656,18,656,26,0],[656,27,656,29,0],[656,30,656,36,0],[657,9,657,10,0],[658,13,658,31,0],[659,13,659,14,0],[660,17,660,48,0],[661,13,661,14,0],[662,9,662,10,0],[664,9,664,25,0],[665,5,665,6,0],[675,5,675,6,0],[676,9,676,101,0],[677,9,677,26,0],[678,9,678,16,0],[678,18,678,26,0],[678,27,678,29,0],[678,30,678,42,0],[679,9,679,10,0],[680,13,680,31,0],[681,13,681,14,0],[682,17,682,48,0],[683,13,683,14,0],[684,9,684,10,0],[686,9,686,25,0],[687,5,687,6,0],[698,5,698,6,0],[700,9,700,10,0],[701,13,701,66,0],[702,13,702,30,0],[703,13,703,46,0],[705,13,705,59,0],[706,13,706,69,0],[707,13,707,45,0],[708,13,708,44,0],[710,9,710,29,0],[711,9,711,10,0],[712,13,712,80,0],[713,9,713,10,0],[715,9,715,30,0],[716,5,716,6,0],[727,5,727,6,0],[729,9,729,10,0],[730,13,730,66,0],[731,13,731,30,0],[732,13,732,46,0],[734,13,734,71,0],[735,13,735,100,0],[736,13,736,46,0],[737,13,737,41,0],[739,9,739,29,0],[740,9,740,10,0],[741,13,741,80,0],[742,9,742,10,0],[744,9,744,30,0],[745,5,745,6,0],[756,5,756,6,0],[758,9,758,10,0],[759,13,759,22,0],[760,13,760,88,0],[761,13,761,45,0],[762,13,762,44,0],[764,9,764,29,0],[765,9,765,10,0],[766,13,766,80,0],[767,9,767,10,0],[769,9,769,30,0],[770,5,770,6,0],[781,5,781,6,0],[783,9,783,10,0],[784,13,784,22,0],[785,13,785,90,0],[786,13,786,46,0],[787,13,787,41,0],[789,9,789,29,0],[790,9,790,10,0],[791,13,791,80,0],[792,9,792,10,0],[794,9,794,30,0],[795,5,795,6,0],[808,5,808,6,0],[809,9,809,72,0],[810,9,810,45,0],[811,9,811,43,0],[813,9,813,10,0],[814,13,814,114,0],[815,13,815,14,0],[816,17,816,56,0],[817,17,817,41,0],[818,17,818,68,0],[821,13,821,77,0],[822,13,822,14,0],[823,17,823,66,0],[824,17,824,41,0],[825,17,825,68,0],[828,13,828,51,0],[829,13,829,14,0],[830,17,830,64,0],[831,17,831,41,0],[832,17,832,68,0],[835,13,836,46,0],[837,13,837,100,0],[838,13,838,51,0],[839,13,839,44,0],[841,9,841,29,0],[842,9,842,10,0],[843,13,843,80,0],[844,9,844,10,0],[846,9,846,30,0],[847,5,847,6,0],[860,5,860,6,0],[861,9,861,72,0],[862,9,862,45,0],[863,9,863,43,0],[865,9,865,10,0],[866,13,866,114,0],[867,13,867,14,0],[868,17,868,56,0],[869,17,869,68,0],[871,13,871,102,0],[872,13,872,14,0],[873,17,873,66,0],[874,17,874,68,0],[877,13,877,51,0],[878,13,878,14,0],[879,17,879,64,0],[880,17,880,68,0],[883,13,884,46,0],[885,13,885,129,0],[886,13,886,52,0],[887,13,887,41,0],[889,9,889,29,0],[890,9,890,10,0],[891,13,891,80,0],[892,9,892,10,0],[894,9,894,30,0],[895,5,895,6,0],[905,5,905,6,0],[907,9,907,10,0],[908,13,908,45,0],[909,13,909,44,0],[911,9,911,29,0],[912,9,912,10,0],[913,13,913,80,0],[914,13,914,34,0],[916,5,916,6,0],[925,5,925,6,0],[927,9,927,10,0],[928,13,928,30,0],[929,13,929,76,0],[930,13,930,49,0],[931,13,931,37,0],[932,13,932,65,0],[934,9,934,29,0],[935,9,935,10,0],[936,13,936,80,0],[937,13,937,34,0],[939,5,939,6,0],[949,5,949,6,0],[951,9,951,10,0],[952,13,952,46,0],[953,13,953,41,0],[955,9,955,29,0],[956,9,956,10,0],[957,13,957,80,0],[958,13,958,34,0],[960,5,960,6,0],[963,5,963,6,0],[965,9,965,37,0],[966,9,966,74,0],[967,9,967,53,0],[968,9,968,83,0],[970,9,973,23,0],[975,9,975,43,0],[976,9,976,41,0],[977,9,977,55,0],[978,5,978,6,0],[981,5,981,6,0],[983,9,983,37,0],[984,9,984,90,0],[985,9,985,53,0],[986,9,986,83,0],[988,9,991,23,0],[993,9,993,43,0],[994,9,994,41,0],[995,9,995,55,0],[996,5,996,6,0],[1006,5,1006,6,0],[1008,9,1008,10,0],[1009,13,1009,43,0],[1010,13,1010,50,0],[1011,13,1011,14,0],[1012,17,1012,84,0],[1013,17,1013,38,0],[1016,13,1016,65,0],[1018,9,1018,29,0],[1019,9,1019,10,0],[1020,13,1020,80,0],[1021,9,1021,10,0],[1023,9,1023,30,0],[1024,5,1024,6,0],[1033,5,1033,6,0],[1035,9,1035,10,0],[1036,13,1036,46,0],[1037,13,1037,50,0],[1038,13,1038,14,0],[1039,17,1039,84,0],[1040,17,1040,38,0],[1043,13,1043,65,0],[1045,9,1045,29,0],[1046,9,1046,10,0],[1047,13,1047,80,0],[1048,9,1048,10,0],[1050,9,1050,30,0],[1051,5,1051,6,0],[1054,5,1054,6,0],[1056,9,1056,10,0],[1057,13,1057,86,0],[1058,13,1058,20,0],[1058,22,1058,32,0],[1058,33,1058,35,0],[1058,36,1058,43,0],[1059,13,1059,14,0],[1060,17,1060,118,0],[1061,17,1061,106,0],[1062,17,1062,104,0],[1063,13,1063,14,0],[1065,13,1065,33,0],[1066,13,1066,49,0],[1068,13,1068,44,0],[1070,13,1070,53,0],[1071,13,1071,91,0],[1072,13,1072,85,0],[1073,13,1073,72,0],[1074,13,1074,101,0],[1075,13,1075,63,0],[1076,13,1076,88,0],[1077,13,1077,70,0],[1078,13,1078,58,0],[1080,13,1083,27,0],[1085,13,1085,69,0],[1087,13,1090,27,0],[1092,13,1092,57,0],[1093,13,1093,50,0],[1094,9,1094,10,0],[1095,9,1095,29,0],[1096,9,1096,10,0],[1097,13,1097,80,0],[1098,9,1098,10,0],[1099,5,1099,6,0],[1108,5,1108,6,0],[1110,9,1110,10,0],[1111,13,1111,52,0],[1112,13,1112,50,0],[1113,13,1113,14,0],[1114,17,1114,84,0],[1115,17,1115,38,0],[1118,13,1118,42,0],[1120,9,1120,29,0],[1121,9,1121,10,0],[1122,13,1122,80,0],[1123,9,1123,10,0],[1125,9,1125,30,0],[1126,5,1126,6,0],[1129,5,1129,6,0],[1131,9,1131,10,0],[1132,13,1132,104,0],[1133,13,1133,46,0],[1135,13,1135,20,0],[1135,22,1135,38,0],[1135,39,1135,41,0],[1135,42,1135,55,0],[1136,13,1136,14,0],[1137,17,1137,50,0],[1138,17,1138,118,0],[1139,17,1139,106,0],[1140,17,1140,104,0],[1141,13,1141,14,0],[1143,13,1143,33,0],[1144,13,1144,49,0],[1146,13,1146,47,0],[1148,13,1148,59,0],[1150,13,1150,48,0],[1151,13,1151,94,0],[1152,13,1152,44,0],[1154,13,1157,27,0],[1159,13,1159,63,0],[1160,9,1160,10,0],[1161,9,1161,29,0],[1162,9,1162,10,0],[1163,13,1163,80,0],[1164,9,1164,10,0],[1165,5,1165,6,0],[1178,5,1178,6,0],[1180,9,1180,10,0],[1181,13,1181,37,0],[1182,13,1182,29,0],[1183,13,1183,27,0],[1184,13,1184,29,0],[1186,13,1186,47,0],[1188,13,1188,42,0],[1189,13,1189,14,0],[1190,17,1190,65,0],[1191,13,1191,14,0],[1193,13,1193,14,0],[1194,17,1194,65,0],[1195,13,1195,14,0],[1197,13,1197,80,0],[1198,13,1198,14,0],[1199,17,1199,35,0],[1200,17,1200,37,0],[1201,17,1201,37,0],[1202,17,1202,45,0],[1203,17,1203,54,0],[1206,13,1206,99,0],[1207,13,1207,39,0],[1208,13,1208,37,0],[1209,13,1209,14,0],[1210,17,1210,40,0],[1211,13,1211,14,0],[1213,13,1213,38,0],[1214,13,1214,14,0],[1215,17,1215,44,0],[1216,13,1216,14,0],[1218,13,1218,38,0],[1219,13,1219,14,0],[1220,17,1220,44,0],[1221,13,1221,14,0],[1223,13,1223,50,0],[1224,13,1224,14,0],[1225,17,1225,84,0],[1226,17,1226,38,0],[1228,9,1228,10,0],[1229,9,1229,29,0],[1230,9,1230,10,0],[1231,13,1231,80,0],[1232,9,1232,10,0],[1234,9,1234,61,0],[1235,5,1235,6,0],[1246,5,1246,6,0],[1248,9,1248,10,0],[1249,13,1249,37,0],[1250,13,1250,29,0],[1251,13,1251,27,0],[1252,13,1252,29,0],[1254,13,1254,47,0],[1256,13,1256,42,0],[1257,13,1257,14,0],[1258,17,1258,65,0],[1259,13,1259,14,0],[1261,13,1261,14,0],[1262,17,1262,65,0],[1263,13,1263,14,0],[1265,13,1265,80,0],[1266,13,1266,14,0],[1267,17,1267,35,0],[1268,17,1268,37,0],[1269,17,1269,37,0],[1270,17,1270,45,0],[1271,17,1271,54,0],[1274,13,1274,99,0],[1275,13,1275,39,0],[1276,13,1276,37,0],[1277,13,1277,14,0],[1278,17,1278,40,0],[1279,13,1279,14,0],[1281,13,1281,38,0],[1282,13,1282,14,0],[1283,17,1283,44,0],[1284,13,1284,14,0],[1286,13,1286,38,0],[1287,13,1287,14,0],[1288,17,1288,44,0],[1289,13,1289,14,0],[1291,13,1291,50,0],[1292,13,1292,14,0],[1293,17,1293,84,0],[1294,17,1294,38,0],[1296,9,1296,10,0],[1297,9,1297,29,0],[1298,9,1298,10,0],[1299,13,1299,80,0],[1300,9,1300,10,0],[1302,9,1302,34,0],[1303,9,1303,41,0],[1304,5,1304,6,0],[1317,5,1317,6,0],[1318,9,1318,41,0],[1319,9,1319,100,0],[1320,9,1320,39,0],[1321,5,1321,6,0],[1334,5,1334,6,0],[1335,9,1335,33,0],[1336,9,1336,25,0],[1337,9,1337,23,0],[1338,9,1338,25,0],[1340,9,1340,43,0],[1342,9,1342,38,0],[1343,9,1343,10,0],[1344,13,1344,61,0],[1345,9,1345,10,0],[1347,9,1347,10,0],[1348,13,1348,61,0],[1349,9,1349,10,0],[1351,9,1351,100,0],[1352,9,1352,35,0],[1353,9,1353,46,0],[1354,9,1354,10,0],[1355,13,1355,80,0],[1356,13,1356,34,0],[1359,9,1359,61,0],[1360,5,1360,6,0],[1369,5,1369,6,0],[1371,9,1371,10,0],[1372,13,1372,76,0],[1373,13,1373,49,0],[1374,13,1374,37,0],[1375,13,1375,64,0],[1377,9,1377,29,0],[1378,9,1378,10,0],[1379,13,1379,80,0],[1380,9,1380,10,0],[1381,9,1381,30,0],[1382,5,1382,6,0],[1391,5,1391,6,0],[1393,9,1393,10,0],[1394,13,1394,76,0],[1395,13,1395,49,0],[1396,13,1396,39,0],[1397,13,1397,64,0],[1399,9,1399,29,0],[1400,9,1400,10,0],[1401,13,1401,80,0],[1402,9,1402,10,0],[1403,9,1403,30,0],[1404,5,1404,6,0],[1413,5,1413,6,0],[1415,9,1415,10,0],[1416,13,1416,45,0],[1417,13,1417,64,0],[1419,9,1419,29,0],[1420,9,1420,10,0],[1421,13,1421,80,0],[1422,9,1422,10,0],[1423,9,1423,30,0],[1424,5,1424,6,0],[1434,5,1434,6,0],[1436,9,1436,10,0],[1437,13,1437,49,0],[1438,13,1438,14,0],[1439,17,1439,45,0],[1440,13,1440,14,0],[1442,13,1442,14,0],[1443,17,1443,53,0],[1444,13,1444,14,0],[1446,13,1446,45,0],[1448,9,1448,29,0],[1449,9,1449,10,0],[1450,13,1450,80,0],[1451,9,1451,10,0],[1452,9,1452,30,0],[1453,5,1453,6,0],[1465,5,1465,6,0],[1467,9,1467,10,0],[1468,13,1468,74,0],[1469,13,1469,42,0],[1470,13,1470,14,0],[1471,17,1471,96,0],[1472,13,1472,14,0],[1474,13,1474,14,0],[1475,17,1475,96,0],[1476,13,1476,14,0],[1478,13,1478,60,0],[1479,13,1479,80,0],[1480,13,1480,33,0],[1481,13,1481,20,0],[1481,22,1481,32,0],[1481,33,1481,35,0],[1481,36,1481,46,0],[1482,13,1482,14,0],[1483,17,1483,49,0],[1484,17,1484,18,0],[1485,21,1485,46,0],[1486,17,1486,18,0],[1487,13,1487,14,0],[1489,13,1489,49,0],[1490,13,1490,77,0],[1492,9,1492,29,0],[1493,9,1493,10,0],[1494,13,1494,74,0],[1495,13,1495,112,0],[1497,5,1497,6,0],[1509,5,1509,6,0],[1511,9,1511,10,0],[1512,13,1512,74,0],[1513,13,1513,42,0],[1514,13,1514,14,0],[1515,17,1515,96,0],[1516,13,1516,14,0],[1518,13,1518,14,0],[1519,17,1519,96,0],[1520,13,1520,14,0],[1522,13,1522,60,0],[1524,13,1524,47,0],[1526,13,1526,42,0],[1527,13,1527,14,0],[1528,17,1528,65,0],[1529,13,1529,14,0],[1531,13,1531,14,0],[1532,17,1532,65,0],[1533,13,1533,14,0],[1535,13,1535,107,0],[1537,13,1537,49,0],[1538,13,1538,112,0],[1540,9,1540,29,0],[1541,9,1541,10,0],[1543,13,1543,14,0],[1544,17,1544,100,0],[1545,17,1545,64,0],[1546,17,1546,84,0],[1547,17,1547,37,0],[1548,17,1548,24,0],[1548,26,1548,36,0],[1548,37,1548,39,0],[1548,40,1548,50,0],[1549,17,1549,18,0],[1550,21,1550,53,0],[1551,21,1551,22,0],[1552,25,1552,50,0],[1553,21,1553,22,0],[1554,17,1554,18,0],[1556,17,1556,60,0],[1558,13,1558,34,0],[1559,13,1559,14,0],[1560,17,1560,95,0],[1563,5,1563,6,0],[1572,5,1572,6,0],[1574,9,1574,10,0],[1575,13,1575,47,0],[1576,13,1576,86,0],[1577,13,1577,20,0],[1577,22,1577,32,0],[1577,33,1577,35,0],[1577,36,1577,43,0],[1578,13,1578,14,0],[1579,17,1579,118,0],[1580,17,1580,106,0],[1581,17,1581,104,0],[1582,13,1582,14,0],[1584,13,1584,42,0],[1585,13,1585,48,0],[1586,13,1586,44,0],[1587,13,1587,45,0],[1588,13,1588,92,0],[1589,13,1590,96,0],[1591,13,1591,20,0],[1591,22,1591,29,0],[1591,30,1591,32,0],[1591,33,1591,43,0],[1592,13,1592,14,0],[1593,17,1593,78,0],[1594,17,1594,111,0],[1595,17,1595,43,0],[1596,13,1596,14,0],[1598,13,1598,20,0],[1598,22,1598,29,0],[1598,30,1598,32,0],[1598,33,1598,43,0],[1599,13,1599,14,0],[1600,17,1600,74,0],[1601,17,1601,111,0],[1602,17,1602,39,0],[1603,13,1603,14,0],[1605,13,1605,20,0],[1605,22,1605,29,0],[1605,30,1605,32,0],[1605,33,1605,43,0],[1606,13,1606,14,0],[1607,17,1607,75,0],[1608,17,1608,111,0],[1609,17,1609,40,0],[1610,13,1610,14,0],[1612,13,1612,47,0],[1613,13,1613,35,0],[1614,13,1614,37,0],[1615,13,1615,49,0],[1616,13,1616,47,0],[1617,13,1617,45,0],[1619,9,1619,29,0],[1620,9,1620,10,0],[1621,13,1621,80,0],[1622,9,1622,10,0],[1624,9,1624,30,0],[1625,5,1625,6,0],[1634,5,1634,6,0],[1636,9,1636,10,0],[1637,13,1637,97,0],[1638,13,1638,70,0],[1640,13,1640,20,0],[1640,22,1640,36,0],[1640,37,1640,39,0],[1640,40,1640,44,0],[1641,13,1641,14,0],[1642,17,1642,35,0],[1643,17,1643,24,0],[1643,26,1643,46,0],[1643,47,1643,49,0],[1643,50,1643,56,0],[1644,17,1644,18,0],[1645,21,1645,67,0],[1646,21,1646,22,0],[1647,25,1647,100,0],[1648,25,1648,38,0],[1649,25,1649,91,0],[1650,25,1650,31,0],[1652,17,1652,18,0],[1654,17,1654,28,0],[1655,17,1655,18,0],[1656,21,1657,54,0],[1658,17,1658,18,0],[1660,17,1660,72,0],[1661,13,1661,14,0],[1663,13,1663,42,0],[1664,13,1664,44,0],[1666,9,1666,29,0],[1667,9,1667,10,0],[1668,13,1668,80,0],[1669,13,1669,34,0],[1671,5,1671,6,0],[1674,5,1674,6,0],[1676,9,1676,10,0],[1677,13,1677,47,0],[1678,13,1678,86,0],[1679,13,1679,20,0],[1679,22,1679,32,0],[1679,33,1679,35,0],[1679,36,1679,43,0],[1680,13,1680,14,0],[1681,17,1681,118,0],[1682,17,1682,106,0],[1683,17,1683,104,0],[1684,13,1684,14,0],[1686,13,1686,42,0],[1687,13,1687,48,0],[1688,13,1688,44,0],[1689,13,1689,45,0],[1690,13,1690,92,0],[1691,13,1692,96,0],[1693,13,1693,20,0],[1693,22,1693,29,0],[1693,30,1693,32,0],[1693,33,1693,43,0],[1694,13,1694,14,0],[1695,17,1695,78,0],[1696,17,1696,111,0],[1697,17,1697,43,0],[1698,13,1698,14,0],[1700,13,1700,20,0],[1700,22,1700,29,0],[1700,30,1700,32,0],[1700,33,1700,43,0],[1701,13,1701,14,0],[1702,17,1702,74,0],[1703,17,1703,111,0],[1704,17,1704,39,0],[1705,13,1705,14,0],[1707,13,1707,20,0],[1707,22,1707,29,0],[1707,30,1707,32,0],[1707,33,1707,43,0],[1708,13,1708,14,0],[1709,17,1709,75,0],[1710,17,1710,111,0],[1711,17,1711,40,0],[1712,13,1712,14,0],[1714,13,1714,47,0],[1715,13,1715,35,0],[1716,13,1716,37,0],[1717,13,1717,49,0],[1718,13,1718,47,0],[1719,9,1719,10,0],[1720,9,1720,29,0],[1721,9,1721,10,0],[1722,13,1722,80,0],[1723,9,1723,10,0],[1724,5,1724,6,0],[1733,5,1733,6,0],[1735,9,1735,10,0],[1736,13,1736,47,0],[1737,13,1737,86,0],[1738,13,1738,20,0],[1738,22,1738,32,0],[1738,33,1738,35,0],[1738,36,1738,43,0],[1739,13,1739,14,0],[1740,17,1740,118,0],[1741,17,1741,106,0],[1742,17,1742,104,0],[1743,13,1743,14,0],[1745,13,1745,42,0],[1746,13,1746,48,0],[1747,13,1748,96,0],[1749,13,1749,44,0],[1750,13,1750,45,0],[1751,13,1751,20,0],[1751,22,1751,29,0],[1751,30,1751,32,0],[1751,33,1751,43,0],[1752,13,1752,14,0],[1753,17,1753,78,0],[1754,17,1754,111,0],[1755,17,1755,43,0],[1756,13,1756,14,0],[1758,13,1758,20,0],[1758,22,1758,29,0],[1758,30,1758,32,0],[1758,33,1758,43,0],[1759,13,1759,14,0],[1760,17,1760,74,0],[1761,17,1761,111,0],[1762,17,1762,39,0],[1763,13,1763,14,0],[1765,13,1765,20,0],[1765,22,1765,29,0],[1765,30,1765,32,0],[1765,33,1765,43,0],[1766,13,1766,14,0],[1767,17,1767,75,0],[1768,17,1768,111,0],[1769,17,1769,40,0],[1770,13,1770,14,0],[1772,13,1772,47,0],[1773,13,1773,35,0],[1774,13,1774,37,0],[1775,13,1775,49,0],[1776,13,1776,47,0],[1777,13,1777,45,0],[1779,9,1779,29,0],[1780,9,1780,10,0],[1781,13,1781,80,0],[1782,9,1782,10,0],[1783,9,1783,30,0],[1784,5,1784,6,0],[1797,5,1797,6,0],[1799,9,1799,10,0],[1800,13,1800,65,0],[1801,13,1801,34,0],[1802,13,1802,14,0],[1803,17,1803,97,0],[1804,17,1804,41,0],[1807,13,1807,34,0],[1808,13,1808,14,0],[1809,17,1809,59,0],[1810,17,1810,41,0],[1813,13,1813,34,0],[1814,13,1814,14,0],[1815,17,1815,59,0],[1816,17,1816,41,0],[1819,13,1819,40,0],[1820,13,1820,14,0],[1821,17,1821,65,0],[1822,17,1822,41,0],[1825,13,1825,50,0],[1826,13,1826,14,0],[1827,17,1827,62,0],[1828,17,1828,41,0],[1831,13,1831,95,0],[1832,13,1832,14,0],[1833,17,1833,57,0],[1834,17,1834,38,0],[1837,13,1837,73,0],[1838,13,1838,37,0],[1840,9,1840,29,0],[1841,9,1841,10,0],[1842,13,1842,80,0],[1843,13,1843,37,0],[1847,5,1847,6,0],[1857,5,1857,6,0],[1858,9,1858,33,0],[1859,5,1859,6,0],[1867,5,1867,6,0],[1868,9,1868,107,0],[1869,5,1869,6,0],[1879,5,1879,6,0],[1880,9,1880,30,0],[1881,5,1881,6,0],[1891,5,1891,6,0],[1893,9,1893,10,0],[1894,13,1894,67,0],[1895,13,1895,20,0],[1895,22,1895,36,0],[1895,37,1895,39,0],[1896,22,1896,94,0],[1897,13,1897,14,0],[1898,17,1899,21,0],[1899,21,1899,99,0],[1899,99,1899,101,0],[1901,17,1901,48,0],[1902,17,1902,18,0],[1903,21,1903,79,0],[1904,21,1904,22,0],[1905,25,1906,86,0],[1907,21,1907,22,0],[1909,21,1909,22,0],[1910,25,1910,114,0],[1911,21,1911,22,0],[1912,17,1912,18,0],[1913,13,1913,14,0],[1915,13,1915,42,0],[1916,13,1916,44,0],[1918,9,1918,29,0],[1919,9,1919,10,0],[1920,13,1920,80,0],[1921,9,1921,10,0],[1922,9,1922,30,0],[1923,5,1923,6,0],[1932,5,1932,6,0],[1934,9,1934,10,0],[1935,13,1935,35,0],[1936,13,1936,43,0],[1938,13,1938,67,0],[1939,13,1939,20,0],[1939,22,1939,36,0],[1939,37,1939,39,0],[1940,22,1940,94,0],[1941,13,1941,14,0],[1942,17,1943,21,0],[1943,21,1943,99,0],[1943,99,1943,101,0],[1945,17,1945,105,0],[1946,17,1946,18,0],[1947,21,1947,47,0],[1948,17,1948,18,0],[1949,13,1949,14,0],[1951,13,1951,35,0],[1952,13,1952,14,0],[1953,17,1953,53,0],[1956,13,1956,59,0],[1958,9,1958,29,0],[1959,9,1959,10,0],[1960,13,1960,80,0],[1961,9,1961,10,0],[1962,9,1962,30,0],[1963,5,1963,6,0],[1973,5,1973,6,0],[1975,9,1975,10,0],[1976,13,1976,67,0],[1977,13,1977,70,0],[1978,13,1981,86,0],[1982,13,1982,66,0],[1983,13,1983,14,0],[1984,17,1984,95,0],[1985,17,1985,43,0],[1986,17,1986,43,0],[1989,13,1989,25,0],[1990,13,1990,14,0],[1991,17,1991,41,0],[1992,17,1992,18,0],[1993,21,1993,84,0],[1994,21,1994,47,0],[1995,21,1995,47,0],[1998,17,1998,43,0],[1999,17,1999,94,0],[2000,17,2000,61,0],[2001,17,2001,55,0],[2004,13,2004,97,0],[2005,13,2005,39,0],[2006,13,2006,39,0],[2008,9,2008,29,0],[2009,9,2009,10,0],[2010,13,2010,80,0],[2011,9,2011,10,0],[2012,9,2012,30,0],[2013,5,2013,6,0],[2020,5,2020,6,0],[2022,9,2022,10,0],[2023,13,2023,36,0],[2024,13,2024,52,0],[2025,13,2025,14,0],[2026,17,2026,67,0],[2027,13,2027,14,0],[2029,13,2029,101,0],[2030,13,2030,63,0],[2030,63,2030,98,0],[2030,98,2030,100,0],[2031,13,2031,45,0],[2032,13,2032,49,0],[2034,13,2034,39,0],[2035,13,2035,27,0],[2037,9,2037,29,0],[2038,9,2038,10,0],[2039,13,2039,80,0],[2040,9,2040,10,0],[2041,9,2041,30,0],[2042,5,2042,6,0]]);
    </script>
  </body>
</html>