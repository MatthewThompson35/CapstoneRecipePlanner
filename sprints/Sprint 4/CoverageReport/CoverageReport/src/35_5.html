<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\matth\source\repos\CapstoneRecipePlanner\code\RecipePlannerApplication\RecipePlannerWebApplication\Views\Home\AddRecipesPage.cshtml</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
&lt;style&gt;
    #addForm,
    #addStepForm,
    #addTagForm {
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.16);
        display: block;
        margin: 30px auto;
        max-width: 600px;
        padding: 20px;
    }

    #addForm {
        height: 500px;
    }

    #addForm input[type=&quot;text&quot;],
    #addStepForm input[type=&quot;text&quot;],
    #addTagForm input[type=&quot;text&quot;],
    #addStepForm select,
    #addForm select,
    #addTagForm select {
        border: 1px solid #e6e6e6;
        border-radius: 5px;
        box-sizing: border-box;
        font-size: 18px;
        margin-bottom: 10px;
        padding: 10px;
        width: 100%;
    }

    #addForm input[type=&quot;submit&quot;],
    #addStepForm input[type=&quot;submit&quot;],
    #addTagForm input[type=&quot;submit&quot;],
    #addStepForm input[type=&quot;button&quot;],
    #addForm input[type=&quot;button&quot;],
    #addTagForm input[type=&quot;button&quot;] {
        background-color: #33b5e5;
        border: none;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
        font-size: 16px;
        margin-right: 10px;
        padding: 5px 10px;
    }

    #addForm #cancelButton,
    #addStepForm #cancelButton,
    #addTagForm #cancelButton {
        background-color: #d9534f;
        color: #fff;
        margin-left: 10px;
    }

    #addForm label,
    #addStepForm label,
    #addTagForm label {
        display: block;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    #addForm .form-group,
    #addStepFrom .form-group,
    #addTagForm .form-group { 
        margin-bottom: 15px; 
    }

    #addForm .button-group,
    #addStepForm .button-group,
    #addTagForm .button-group {
        margin-top: 20px;
        text-align: right;
    }

    #addRecipe {
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.16);
        display: block;
        margin: 30px auto;
        max-width: 1200px;
        padding: 20px;
    }

    #addRecipe input[type=&quot;text&quot;],
    #addRecipe select {
        border: 1px solid #e6e6e6;
        border-radius: 5px;
        box-sizing: border-box;
        font-size: 18px;
        margin-bottom: 10px;
        padding: 10px;
        width: 100%;
    }

    #addRecipe input[type=&quot;submit&quot;],
    #addRecipe input[type=&quot;button&quot;] {
        background-color: #33b5e5;
        border: none;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
        font-size: 16px;
        margin-right: 10px;
        padding: 5px 10px;
    }

    #addRecipe #cancelButton {
        background-color: #d9534f;
        color: #fff;
        margin-left: 10px;
    }

    #addRecipe label {
        display: block;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    #addRecipe .form-group { margin-bottom: 15px; }

    #addRecipe .button-group {
        margin-top: 20px;
        text-align: right;
    }

    .form-container label.error { font-size: 14px; }

&lt;/style&gt;

&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-md-12&quot;&gt;
        &lt;form id=&quot;addRecipe&quot;&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;span id=&quot;recipe-error&quot; style=&quot;color: red;&quot;&gt;&lt;/span&gt;
                &lt;label for=&quot;recipeName&quot;&gt;Recipe Name:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;recipeName&quot; id=&quot;recipeName&quot;/&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;description&quot;&gt;Description:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;description&quot; id=&quot;description&quot;/&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;h1&gt;Ingredients&lt;/h1&gt;
                &lt;table id=&quot;IngredientsTable&quot; class=&quot;table&quot;&gt;
                    &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;Ingredient Name&lt;/th&gt;
                        &lt;th&gt;Quantity&lt;/th&gt;
                        &lt;th&gt;Measurement&lt;/th&gt;
                        &lt;th&gt;Action&lt;/th&gt;
                    &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody&gt;

                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;h1&gt;Steps&lt;/h1&gt;
                &lt;table id=&quot;StepsTable&quot; class=&quot;table&quot;&gt;
                    &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;Step&lt;/th&gt;
                        &lt;th&gt;Action&lt;/th&gt;
                    &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody&gt;

                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;h1&gt;Tags&lt;/h1&gt;
                &lt;table id=&quot;TagsTable&quot; class=&quot;table&quot;&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th&gt;Tag&lt;/th&gt;
                            &lt;th&gt;Action&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/div&gt;
        &lt;/form&gt;
        &lt;h4&gt;Please add all ingredients and steps in order&lt;/h4&gt;
    &lt;/div&gt;
    &lt;h2&gt;Ingredients&lt;/h2&gt;
    &lt;div class=&quot;col-md-6&quot;&gt;
        &lt;form id=&quot;addForm&quot;&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;span id=&quot;ingredient-error&quot; style=&quot;color: red;&quot;&gt;&lt;/span&gt;
                &lt;label for=&quot;txtIngredientName&quot;&gt;Ingredient Name:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;txtIngredientName&quot; id=&quot;txtIngredientName&quot;/&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;txtQuantity&quot;&gt;Quantity:&lt;/label&gt;
                &lt;span id=&quot;quantity-error&quot; style=&quot;color: red;&quot;&gt;&lt;/span&gt;
                &lt;input type=&quot;text&quot; name=&quot;txtQuantity&quot; id=&quot;txtQuantity&quot;/&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;measurement&quot;&gt;Measurement:&lt;/label&gt;
                &lt;select name=&quot;Measurement&quot; id=&quot;measurement&quot;&gt;
                    @foreach (var measurement in ViewBag.measurements)
                    {
                        &lt;option value=&quot;@measurement&quot;&gt;@measurement&lt;/option&gt;
                    }
                &lt;/select&gt;
                @if (ViewBag.Error != null)
                {
                    &lt;label class=&quot;error&quot; style=&quot;color: red&quot;&gt;@ViewBag.Error&lt;/label&gt;
                }
            &lt;/div&gt;
            &lt;div class=&quot;button-group&quot;&gt;
                &lt;button onsubmit=&quot;addIngredient()&quot; class=&quot;btn btn-primary page-button&quot; id=&quot;addIngredientButton&quot;&gt;Add Ingredient&lt;/button&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/div&gt;
    &lt;div class=&quot;col-md-6&quot;&gt;
        &lt;h2&gt;Steps&lt;/h2&gt;
        &lt;form id=&quot;addStepForm&quot;&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;recipeName&quot;&gt;Recipe Step:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;recipeStep&quot; id=&quot;recipeStep&quot;/&gt;
            &lt;/div&gt;
            &lt;button onsubmit=&quot;addStep()&quot; class=&quot;btn btn-primary page-button&quot; id=&quot;addStepButton&quot;&gt;Add Step&lt;/button&gt;
        &lt;/form&gt;
        &lt;h2&gt;Tags&lt;/h2&gt;
        &lt;form id=&quot;addTagForm&quot;&gt;
            &lt;div class=&quot;form-group&quot;&gt;
                &lt;span id=&quot;tag-error&quot; style=&quot;color: red;&quot;&gt;&lt;/span&gt;
                &lt;label for=&quot;recipeName&quot;&gt;Recipe Tag:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;recipeTag&quot; id=&quot;recipeTag&quot;/&gt;
            &lt;/div&gt;
            &lt;button onsubmit=&quot;addTag()&quot; class=&quot;btn btn-primary page-button&quot; id=&quot;addTagButton&quot;&gt;Add Tag&lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;
    &lt;form id=&quot;buttons&quot;&gt;
        &lt;button asp-action=&quot;goToRecipePage&quot; class=&quot;btn btn-primary page-button&quot; id=&quot;addRecipeButton&quot;&gt;Add Recipe&lt;/button&gt;
        &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary page-button&quot; asp-action=&quot;goToRecipePage&quot; value=&quot;Cancel&quot; id=&quot;cancelRecipe&quot;/&gt;
    &lt;/form&gt;
&lt;/div&gt;


@{
    if (TempData[&quot;msg&quot;] != null)
    {
        &lt;script&gt;
            alert(&#39;@TempData[&quot;msg&quot;]&#39;)
        &lt;/script&gt;
    }
}

&lt;script&gt;
 var addIngredientButton = document.getElementById(&#39;addIngredientButton&#39;);
 var addStepButton = document.getElementById(&quot;addStepButton&quot;);
 
 
 document.getElementById(&#39;addForm&#39;).addEventListener(&#39;submit&#39;, function(event) {

        event.preventDefault();


        addIngredient();

        document.getElementById(&#39;txtIngredientName&#39;).value = &#39;&#39;;
        document.getElementById(&#39;txtQuantity&#39;).value = &#39;&#39;;
        document.getElementById(&#39;measurement&#39;).selectedIndex = 0;
    });
    
    document.getElementById(&#39;addTagForm&#39;).addEventListener(&#39;submit&#39;, function (event) {

        event.preventDefault();


        addTag();

        document.getElementById(&#39;recipeTag&#39;).value = &#39;&#39;;
    });
    
 document.getElementById(&#39;addStepForm&#39;).addEventListener(&#39;submit&#39;, function(event) {

        event.preventDefault();


        addStep();

        document.getElementById(&#39;recipeStep&#39;).value = &#39;&#39;;
    });

 function addStep() {

      var row = document.createElement(&#39;tr&#39;);
      var stepValue = document.getElementById(&quot;recipeStep&quot;).value;

      var nameCell = document.createElement(&#39;td&#39;);
      nameCell.innerText = stepValue;
      row.appendChild(nameCell);

      var actionsCell = document.createElement(&#39;td&#39;);
      var deleteButton = document.createElement(&#39;button&#39;);
      deleteButton.innerText = &#39;Delete&#39;;
      deleteButton.onclick = function() {
        row.remove();
      };
      actionsCell.appendChild(deleteButton);
      row.appendChild(actionsCell);

      var table = document.getElementById(&#39;StepsTable&#39;).getElementsByTagName(&#39;tbody&#39;)[0];
  table.appendChild(row);

}
    const addButton = document.getElementById(&#39;addRecipeButton&#39;);
    addButton.addEventListener(&#39;click&#39;, function (event) {
        var errorLabel = document.getElementById(&#39;recipe-error&#39;);

        addRecipe(event);
    });

    function addRecipe(event) {
        const ingredientsTable = document.getElementById(&#39;IngredientsTable&#39;);
        const ingredientsTbody = ingredientsTable.getElementsByTagName(&#39;tbody&#39;)[0];
        const ingredientsRows = ingredientsTbody.getElementsByTagName(&#39;tr&#39;);

        const stepsTable = document.getElementById(&#39;StepsTable&#39;);
        const stepsTbody = stepsTable.getElementsByTagName(&#39;tbody&#39;)[0];
        const stepsRows = stepsTbody.getElementsByTagName(&#39;tr&#39;);
        const tagsTable = document.getElementById(&#39;TagsTable&#39;);
        const tagsTbody = tagsTable.getElementsByTagName(&#39;tbody&#39;)[0];
        const tagsRows = tagsTbody.getElementsByTagName(&#39;tr&#39;);

        var tagsString = &quot;&quot;;
        var errorLabel = document.getElementById(&#39;recipe-error&#39;);
        var stepsString = &quot;&quot;;
        var ingredientsString = &quot;&quot;;
        errorLabel.textContent = &#39;clicked&#39;;
        const recipeNameInput = document.getElementById(&#39;recipeName&#39;);
        const recipeDescriptionInput = document.getElementById(&#39;description&#39;);

        const recipeName = recipeNameInput.value;
        const recipeDescription = recipeDescriptionInput.value;

        if (ingredientsRows.length &gt; 0 &amp;&amp; tagsRows.length &gt; 0 &amp;&amp; stepsRows.length &gt; 0 &amp;&amp; recipeName != null &amp;&amp; recipeDescription != null) {
            for (let i = 0; i &lt; ingredientsRows.length; i++) {
                const cells = ingredientsRows[i].getElementsByTagName(&#39;td&#39;);
                var ingredientString = `${cells[0].textContent},${cells[1].textContent},${cells[2].textContent}`;
                if (i &gt; 0) {
                    ingredientsString += `:${ingredientString}`;
                } else {
                    ingredientsString = ingredientString;
                }
            }
            for (let i = 0; i &lt; stepsRows.length; i++) {
                const cells = stepsRows[i].getElementsByTagName(&#39;td&#39;);
                var stepString = `${i + 1},${cells[0].textContent}`;
                if (i &gt; 0) {
                    stepsString += `:${stepString}`;
                } else {
                    stepsString = stepString;
                }
            }
            for (let i = 0; i &lt; tagsRows.length; i++) {
                const cells = tagsRows[i].getElementsByTagName(&#39;td&#39;);
                var tagString = `${cells[0].textContent}`;
                if (i &gt; 0) {
                    tagsString += `:${tagString}`;
                } else {
                    tagsString = tagString;
                }
            }
            console.log(recipeName);
            console.log(recipeDescription);
            console.log(&#39;here&#39;);
            $.ajax({
                url: &quot;@Url.Action(&quot;AddRecipe&quot;, &quot;Home&quot;)&quot;,
                method: &#39;POST&#39;,
                data: { recipeName: recipeName, description: recipeDescription, steps: stepsString, ingredients: ingredientsString, tags: tagsString },
                success: function (response) {
                    console.log(&#39;Recipe added successfully!&#39;);
                },
                error: function (xhr, status, error) {
                    console.log(&#39;Error adding recipe:&#39;, error);
                }
            });
        } else {
            event.preventDefault();
            errorLabel.textContent = &#39;ALL TABLES MUST HAVE VALUES!&#39;;
        }
    }

    function addTag() {
        var tag = document.getElementById(&#39;recipeTag&#39;).value.trim();
        document.getElementById(&#39;tag-error&#39;).innerText = &#39;&#39;;
        if (tag === &#39;&#39;) {
            alert(&#39;Please enter a tag.&#39;);
            return;
        }

        var table = document.getElementById(&#39;TagsTable&#39;);
        var tags = table.querySelectorAll(&#39;tbody tr td:first-child&#39;);

        for (var i = 0; i &lt; tags.length; i++) {
            if (tags[i].innerText.toLowerCase() === tag.toLowerCase()) {
                document.getElementById(&#39;tag-error&#39;).innerText = &#39;Tag already exists.&#39;;
                return;
            }
        }

        var row = document.createElement(&#39;tr&#39;);

        var tagCell = document.createElement(&#39;td&#39;);
        tagCell.innerText = tag;
        row.appendChild(tagCell);

        var actionsCell = document.createElement(&#39;td&#39;);

        var deleteButton = document.createElement(&#39;button&#39;);
        deleteButton.innerText = &#39;Delete&#39;;
        deleteButton.onclick = function () {
            row.remove();
        };

        actionsCell.appendChild(deleteButton);
        row.appendChild(actionsCell);

        table.getElementsByTagName(&#39;tbody&#39;)[0].appendChild(row);

        document.getElementById(&#39;tag-error&#39;).innerText = &#39;&#39;;
    }


    function addIngredient() {
        var name = document.getElementById(&#39;txtIngredientName&#39;).value;
        var quantity = document.getElementById(&#39;txtQuantity&#39;).value;
        var measurement = document.getElementById(&#39;measurement&#39;).value;

        var errorLabel = document.getElementById(&#39;quantity-error&#39;);
        if (!errorLabel) {
            errorLabel = document.createElement(&#39;span&#39;);
            errorLabel.id = &#39;quantity-error&#39;;
            errorLabel.style.color = &#39;red&#39;;
            var quantityInput = document.getElementById(&#39;txtQuantity&#39;);
            quantityInput.parentNode.insertBefore(errorLabel, quantityInput.nextSibling);
        }
        errorLabel.textContent = &#39;&#39;;
        if (isNaN(quantity)) {
            var errorLabel = document.getElementById(&#39;quantity-error&#39;);
            if (!errorLabel) {
                errorLabel = document.createElement(&#39;span&#39;);
                errorLabel.id = &#39;quantity-error&#39;;
                errorLabel.style.color = &#39;red&#39;;
                var quantityInput = document.getElementById(&#39;txtQuantity&#39;);
                quantityInput.parentNode.insertBefore(errorLabel, quantityInput.nextSibling);
            }
            errorLabel.textContent = &#39;Quantity must be an integer.&#39;;
            return;
        }

        var table = document.getElementById(&#39;IngredientsTable&#39;);
        var rows = table.querySelectorAll(&#39;tbody tr&#39;);
        var foundRow = null;

        for (var i = 0; i &lt; rows.length; i++) {
            if (rows[i].cells[0].innerText.toLowerCase() === name.toLowerCase()) {
                foundRow = rows[i];
                break;
            }
        }

        if (foundRow) {
            var existingQuantity = parseInt(foundRow.cells[1].innerText);
            foundRow.cells[1].innerText = existingQuantity + parseInt(quantity);
        } else {
            var row = document.createElement(&#39;tr&#39;);

            var nameCell = document.createElement(&#39;td&#39;);
            nameCell.innerText = name;
            row.appendChild(nameCell);

            var quantityCell = document.createElement(&#39;td&#39;);
            quantityCell.innerText = quantity;
            row.appendChild(quantityCell);

            var measurementCell = document.createElement(&#39;td&#39;);
            measurementCell.innerText = measurement;
            row.appendChild(measurementCell);

            var actionsCell = document.createElement(&#39;td&#39;);
            var deleteButton = document.createElement(&#39;button&#39;);
            deleteButton.innerText = &#39;Delete&#39;;
            deleteButton.onclick = function () {
                row.remove();
            };
            actionsCell.appendChild(deleteButton);
            row.appendChild(actionsCell);

            table.getElementsByTagName(&#39;tbody&#39;)[0].appendChild(row);
        }

        document.getElementById(&#39;txtIngredientName&#39;).value = &#39;&#39;;
        document.getElementById(&#39;txtQuantity&#39;).value = &#39;&#39;;
    }



&lt;/script&gt;
    </pre>
    <script type="text/javascript">
      highlightRanges([[210,22,210,29,0],[210,31,210,46,0],[210,47,210,49,0],[210,50,210,70,0],[211,21,211,22,0],[212,41,212,53,0],[212,55,212,67,0],[213,21,213,22,0],[215,18,215,44,0],[216,17,216,18,0],[217,62,217,76,0],[218,17,218,18,0],[252,5,252,33,0],[253,5,253,6,0],[255,21,255,37,0],[257,5,257,6,0],[381,24,381,56,0]]);
    </script>
  </body>
</html>